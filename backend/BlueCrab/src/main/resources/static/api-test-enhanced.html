<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueCrab API í…ŒìŠ¤íŠ¸ ë„êµ¬ (Enhanced)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            margin-bottom: 5px;
        }

        .mode-toggle {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-toggle button {
            background: #f39c12;
            padding: 10px 20px;
            font-size: 13px;
        }
        
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }
        
        .section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }

        .form-group {
            margin-bottom: 12px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
            font-size: 13px;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        input[type="datetime-local"] {
            font-family: inherit;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        button {
            background: #3498db;
            color: white;
            padding: 10px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
            margin: 5px 5px 5px 0;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        button.success {
            background: #27ae60;
        }
        
        button.success:hover {
            background: #219a52;
        }
        
        button.danger {
            background: #e74c3c;
        }
        
        button.danger:hover {
            background: #c0392b;
        }

        button.warning {
            background: #f39c12;
        }

        button.warning:hover {
            background: #e67e22;
        }

        button.purple {
            background: #9b59b6;
        }

        button.purple:hover {
            background: #8e44ad;
        }
        
        .response {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .token-info {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 12px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 12px;
        }

        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 12px;
        }

        .preset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 8px;
        }

        .preset-buttons button {
            font-size: 11px;
            padding: 6px 10px;
            margin: 0;
        }

        .scenario-section {
            background: #fff9e6;
            border: 2px solid #f39c12;
            border-radius: 8px;
            padding: 15px;
            margin: 20px;
        }

        .scenario-section h3 {
            color: #f39c12;
            border-bottom: 2px solid #f39c12;
        }

        .scenario-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .scenario-buttons button {
            padding: 12px;
            font-size: 13px;
            font-weight: bold;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦€ BlueCrab API í…ŒìŠ¤íŠ¸ ë„êµ¬ (Enhanced)</h1>
            <p>ìŠ¤ë§ˆíŠ¸ ì…ë ¥ í¼ & ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸</p>
            <div class="mode-toggle">
                <button onclick="window.location.href='/api-test.html'">ğŸ“„ ê¸°ë³¸ ëª¨ë“œ</button>
                <button onclick="window.location.href='/api-test-dual.html'">ğŸ‘¥ ë“€ì–¼ ëª¨ë“œ</button>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
        <div class="scenario-section">
            <h3>ğŸ¬ ìë™ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸</h3>
            <div class="info-box">
                <strong>ğŸ’¡ íŒ:</strong> ë²„íŠ¼ í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ì „ì²´ í”Œë¡œìš°ë¥¼ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤!
            </div>
            <div class="scenario-buttons">
                <button class="success" onclick="runScenario('reservationFlow')">
                    ğŸ“ ì˜ˆì•½ ìƒì„± â†’ ìŠ¹ì¸ â†’ ì·¨ì†Œ í”Œë¡œìš°
                </button>
                <button class="warning" onclick="runScenario('reservationReject')">
                    âŒ ì˜ˆì•½ ìƒì„± â†’ ë°˜ë ¤ í”Œë¡œìš°
                </button>
                <button class="purple" onclick="runScenario('statusTransition')">
                    ğŸ”„ ëª¨ë“  ìƒíƒœ ì „í™˜ í…ŒìŠ¤íŠ¸
                </button>
                <button class="danger" onclick="runScenario('cancelAfterApprove')">
                    âš ï¸ ìŠ¹ì¸ í›„ ì·¨ì†Œ ì‹œë‚˜ë¦¬ì˜¤
                </button>
            </div>
            <div id="scenarioLog" class="response" style="margin-top: 15px; max-height: 200px;">
                ì‹œë‚˜ë¦¬ì˜¤ ì‹¤í–‰ ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
            </div>
        </div>
        
        <div class="content">
            <!-- ë¡œê·¸ì¸ ì„¹ì…˜ -->
            <div class="section">
                <h3>ğŸ” ë¡œê·¸ì¸ & ì¸ì¦</h3>
                
                <div class="form-group">
                    <label for="username">ì‚¬ìš©ìëª… (ì´ë©”ì¼)</label>
                    <input type="email" id="username" value="student@university.edu">
                </div>
                
                <div class="form-group">
                    <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="password" value="student123">
                </div>

                <div class="preset-buttons">
                    <button onclick="setCredentials('student')" class="success">í•™ìƒ ê³„ì •</button>
                    <button onclick="setCredentials('admin')" class="danger">ê´€ë¦¬ì ê³„ì •</button>
                </div>
                
                <button onclick="login()">ë¡œê·¸ì¸</button>
                <button onclick="logout()" class="danger">ë¡œê·¸ì•„ì›ƒ</button>
                
                <div id="tokenInfo" class="token-info" style="display: none;">
                    <div><strong>ë¡œê·¸ì¸:</strong> <span id="userInfo">-</span></div>
                    <div><strong>ë§Œë£Œ:</strong> <span id="tokenExpiry">-</span></div>
                </div>
            </div>
            
            <!-- ìŠ¤ë§ˆíŠ¸ API í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
            <div class="section">
                <h3>ğŸ§ª ìŠ¤ë§ˆíŠ¸ API í…ŒìŠ¤íŠ¸</h3>
                
                <div class="form-group">
                    <label for="testEndpoint">í…ŒìŠ¤íŠ¸ ì—”ë“œí¬ì¸íŠ¸</label>
                    <select id="testEndpoint" onchange="updateSmartForm()">
                        <option value="ping">Ping (ì¸ì¦ ë¶ˆí•„ìš”)</option>
                        <option value="reservation-create">âœ¨ ì‹œì„¤ ì˜ˆì•½ ìƒì„±</option>
                        <option value="reservation-update-status">âœ¨ ì˜ˆì•½ ìƒíƒœ ë³€ê²½ (ê´€ë¦¬ì)</option>
                        <option value="reservation-cancel">âœ¨ ì˜ˆì•½ ì·¨ì†Œ</option>
                        <option value="reservation-list">ì˜ˆì•½ ëª©ë¡ ì¡°íšŒ</option>
                        <option value="facility-availability">ì‹œì„¤ ê°€ìš©ì„± í™•ì¸</option>
                        <option value="custom">ì»¤ìŠ¤í…€ URL</option>
                    </select>
                </div>

                <div id="customUrlGroup" class="form-group hidden">
                    <label for="customUrl">ì»¤ìŠ¤í…€ URL</label>
                    <input type="text" id="customUrl" placeholder="/api/custom">
                </div>

                <div id="smartFormContainer">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ìŠ¤ë§ˆíŠ¸ í¼ -->
                </div>

                <button onclick="testApi()">API í˜¸ì¶œ</button>
                <button onclick="clearResponse()" class="danger">ì‘ë‹µ ì§€ìš°ê¸°</button>
            </div>
        </div>
        
        <!-- ì‘ë‹µ ì„¹ì…˜ -->
        <div class="section full-width" style="margin: 20px;">
            <h3>ğŸ“Š ì‘ë‹µ ê²°ê³¼</h3>
            <div id="response" class="response">ì—¬ê¸°ì— API ì‘ë‹µì´ í‘œì‹œë©ë‹ˆë‹¤...</div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let accessToken = localStorage.getItem('accessToken') || '';
        let currentReservationId = null; // ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ìš©
        const API_BASE = '';

        // í˜ì´ì§€ ë¡œë“œ
        window.onload = function() {
            updateTokenInfo();
            updateSmartForm();
        };

        // ìê²© ì¦ëª… ì„¤ì •
        function setCredentials(type) {
            if (type === 'student') {
                document.getElementById('username').value = 'student@university.edu';
                document.getElementById('password').value = 'student123';
            } else if (type === 'admin') {
                document.getElementById('username').value = 'admin@university.edu';
                document.getElementById('password').value = 'admin123';
            }
        }

        // ë¡œê·¸ì¸
        async function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            try {
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    accessToken = data.data.accessToken;
                    localStorage.setItem('accessToken', accessToken);
                    localStorage.setItem('userInfo', JSON.stringify(data.data.userInfo));
                    updateResponse(`âœ… ë¡œê·¸ì¸ ì„±ê³µ!\n\n${JSON.stringify(data, null, 2)}`);
                    updateTokenInfo();
                } else {
                    updateResponse(`âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ${data.message}`);
                }
            } catch (error) {
                updateResponse(`âŒ ì˜¤ë¥˜: ${error.message}`);
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            accessToken = '';
            localStorage.removeItem('accessToken');
            localStorage.removeItem('userInfo');
            updateResponse('âœ… ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
            updateTokenInfo();
        }

        // ìŠ¤ë§ˆíŠ¸ í¼ ì—…ë°ì´íŠ¸
        function updateSmartForm() {
            const endpoint = document.getElementById('testEndpoint').value;
            const container = document.getElementById('smartFormContainer');
            const customUrlGroup = document.getElementById('customUrlGroup');
            
            customUrlGroup.classList.toggle('hidden', endpoint !== 'custom');
            
            let html = '';
            
            if (endpoint === 'reservation-create') {
                html = `
                    <div class="info-box">
                        <strong>ğŸ“ ì‹œì„¤ ì˜ˆì•½ ìƒì„±</strong><br>
                        POST /api/reservations
                    </div>
                    
                    <div class="form-group">
                        <label for="facilityIdx">ì‹œì„¤ ID</label>
                        <input type="number" id="facilityIdx" value="1" min="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="startTime">ì‹œì‘ ì‹œê°„</label>
                        <input type="datetime-local" id="startTime">
                    </div>
                    
                    <div class="form-group">
                        <label for="endTime">ì¢…ë£Œ ì‹œê°„</label>
                        <input type="datetime-local" id="endTime">
                    </div>
                    
                    <div class="form-group">
                        <label for="partySize">ì¸ì› ìˆ˜</label>
                        <input type="number" id="partySize" value="4" min="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="purpose">ì‚¬ìš© ëª©ì </label>
                        <input type="text" id="purpose" placeholder="ìŠ¤í„°ë”” ëª¨ì„">
                    </div>
                    
                    <div class="form-group">
                        <label for="requestedEquipment">í•„ìš” ì¥ë¹„</label>
                        <input type="text" id="requestedEquipment" placeholder="ë¹” í”„ë¡œì í„°">
                    </div>

                    <div class="preset-buttons">
                        <button onclick="setQuickDateTime(1)" class="warning">1ì‹œê°„ í›„</button>
                        <button onclick="setQuickDateTime(2)" class="warning">2ì‹œê°„ í›„</button>
                        <button onclick="setQuickDateTime(24)" class="warning">ë‚´ì¼</button>
                    </div>
                `;
                
                // ê¸°ë³¸ê°’ ì„¤ì •
                setTimeout(() => {
                    setQuickDateTime(1);
                }, 100);
                
            } else if (endpoint === 'reservation-update-status') {
                html = `
                    <div class="info-box">
                        <strong>ğŸ”„ ì˜ˆì•½ ìƒíƒœ ë³€ê²½ (ê´€ë¦¬ì ì „ìš©)</strong><br>
                        PUT /api/reservations/{id}/status
                    </div>
                    
                    <div class="form-group">
                        <label for="reservationId">ì˜ˆì•½ ID</label>
                        <input type="number" id="reservationId" placeholder="ì˜ˆì•½ ID ì…ë ¥">
                    </div>
                    
                    <div class="form-group">
                        <label for="statusSelect">ë³€ê²½í•  ìƒíƒœ</label>
                        <select id="statusSelect">
                            <option value="PENDING">â³ PENDING (ëŒ€ê¸°ì¤‘)</option>
                            <option value="APPROVED">âœ… APPROVED (ìŠ¹ì¸ë¨)</option>
                            <option value="REJECTED">âŒ REJECTED (ë°˜ë ¤ë¨)</option>
                            <option value="CANCELLED">ğŸš« CANCELLED (ì·¨ì†Œë¨)</option>
                            <option value="COMPLETED">âœ”ï¸ COMPLETED (ì™„ë£Œë¨)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="adminNote">ê´€ë¦¬ì ë©”ëª¨ (ì„ íƒ)</label>
                        <textarea id="adminNote" rows="2" placeholder="ìŠ¹ì¸/ë°˜ë ¤ ì‚¬ìœ "></textarea>
                    </div>
                `;
                
            } else if (endpoint === 'reservation-cancel') {
                html = `
                    <div class="warning-box">
                        <strong>âš ï¸ ì˜ˆì•½ ì·¨ì†Œ</strong><br>
                        DELETE /api/reservations/{id}
                    </div>
                    
                    <div class="form-group">
                        <label for="cancelReservationId">ì·¨ì†Œí•  ì˜ˆì•½ ID</label>
                        <input type="number" id="cancelReservationId" placeholder="ì˜ˆì•½ ID ì…ë ¥">
                    </div>
                `;
                
            } else if (endpoint === 'reservation-list') {
                html = `
                    <div class="info-box">
                        <strong>ğŸ“‹ ì˜ˆì•½ ëª©ë¡ ì¡°íšŒ</strong><br>
                        GET /api/reservations/my
                    </div>
                    
                    <div class="form-group">
                        <label for="statusFilter">ìƒíƒœ í•„í„°</label>
                        <select id="statusFilter">
                            <option value="">ì „ì²´</option>
                            <option value="PENDING">â³ ëŒ€ê¸°ì¤‘</option>
                            <option value="APPROVED">âœ… ìŠ¹ì¸ë¨</option>
                            <option value="REJECTED">âŒ ë°˜ë ¤ë¨</option>
                            <option value="CANCELLED">ğŸš« ì·¨ì†Œë¨</option>
                            <option value="COMPLETED">âœ”ï¸ ì™„ë£Œë¨</option>
                        </select>
                    </div>
                `;
                
            } else if (endpoint === 'facility-availability') {
                html = `
                    <div class="info-box">
                        <strong>ğŸ“… ì‹œì„¤ ê°€ìš©ì„± í™•ì¸</strong><br>
                        GET /api/facilities/{id}/availability
                    </div>
                    
                    <div class="form-group">
                        <label for="checkFacilityId">ì‹œì„¤ ID</label>
                        <input type="number" id="checkFacilityId" value="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="checkDate">í™•ì¸ ë‚ ì§œ</label>
                        <input type="date" id="checkDate">
                    </div>
                `;
                
                setTimeout(() => {
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('checkDate').value = today;
                }, 100);
            }
            
            container.innerHTML = html;
        }

        // ë¹ ë¥¸ ë‚ ì§œ/ì‹œê°„ ì„¤ì •
        function setQuickDateTime(hoursFromNow) {
            const start = new Date();
            start.setHours(start.getHours() + hoursFromNow);
            start.setMinutes(0);
            start.setSeconds(0);
            
            const end = new Date(start);
            end.setHours(end.getHours() + 2);
            
            const startInput = document.getElementById('startTime');
            const endInput = document.getElementById('endTime');
            
            if (startInput) {
                startInput.value = formatDateTimeLocal(start);
            }
            if (endInput) {
                endInput.value = formatDateTimeLocal(end);
            }
        }

        // ë‚ ì§œ í¬ë§·íŒ…
        function formatDateTimeLocal(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${year}-${month}-${day}T${hours}:${minutes}`;
        }

        // API í…ŒìŠ¤íŠ¸
        async function testApi() {
            const endpoint = document.getElementById('testEndpoint').value;
            
            let url = '';
            let method = 'GET';
            let body = null;
            
            if (endpoint === 'ping') {
                url = '/api/ping';
            } else if (endpoint === 'reservation-create') {
                url = '/api/reservations';
                method = 'POST';
                body = {
                    facilityIdx: parseInt(document.getElementById('facilityIdx').value),
                    startTime: document.getElementById('startTime').value.replace('T', ' ') + ':00',
                    endTime: document.getElementById('endTime').value.replace('T', ' ') + ':00',
                    partySize: parseInt(document.getElementById('partySize').value),
                    purpose: document.getElementById('purpose').value,
                    requestedEquipment: document.getElementById('requestedEquipment').value
                };
            } else if (endpoint === 'reservation-update-status') {
                const id = document.getElementById('reservationId').value;
                url = `/api/reservations/${id}/status`;
                method = 'PUT';
                body = {
                    status: document.getElementById('statusSelect').value,
                    adminNote: document.getElementById('adminNote').value
                };
            } else if (endpoint === 'reservation-cancel') {
                const id = document.getElementById('cancelReservationId').value;
                url = `/api/reservations/${id}`;
                method = 'DELETE';
            } else if (endpoint === 'reservation-list') {
                const status = document.getElementById('statusFilter').value;
                url = '/api/reservations/my' + (status ? `?status=${status}` : '');
            } else if (endpoint === 'facility-availability') {
                const id = document.getElementById('checkFacilityId').value;
                const date = document.getElementById('checkDate').value;
                url = `/api/facilities/${id}/availability?date=${date}`;
            } else if (endpoint === 'custom') {
                url = document.getElementById('customUrl').value;
            }
            
            try {
                updateResponse('ğŸ”„ API í˜¸ì¶œ ì¤‘...');
                
                const options = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                };
                
                if (accessToken && endpoint !== 'ping') {
                    options.headers['Authorization'] = `Bearer ${accessToken}`;
                }
                
                if (body) {
                    options.body = JSON.stringify(body);
                }
                
                const response = await fetch(`${API_BASE}${url}`, options);
                const data = await response.json();
                
                // ì˜ˆì•½ ID ì €ì¥ (ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ìš©)
                if (endpoint === 'reservation-create' && data.success && data.data) {
                    currentReservationId = data.data.reservationIdx || data.data.id;
                }
                
                const result = `${response.ok ? 'âœ…' : 'âŒ'} ${response.status}\n\n${JSON.stringify(data, null, 2)}`;
                updateResponse(result);
                
            } catch (error) {
                updateResponse(`âŒ ì˜¤ë¥˜: ${error.message}`);
            }
        }

        // ì‹œë‚˜ë¦¬ì˜¤ ì‹¤í–‰
        async function runScenario(scenarioType) {
            updateScenarioLog('ğŸ¬ ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘: ' + scenarioType);
            
            try {
                if (scenarioType === 'reservationFlow') {
                    await reservationFlowScenario();
                } else if (scenarioType === 'reservationReject') {
                    await reservationRejectScenario();
                } else if (scenarioType === 'statusTransition') {
                    await statusTransitionScenario();
                } else if (scenarioType === 'cancelAfterApprove') {
                    await cancelAfterApproveScenario();
                }
                
                updateScenarioLog('\nâœ… ì‹œë‚˜ë¦¬ì˜¤ ì™„ë£Œ!');
            } catch (error) {
                updateScenarioLog(`\nâŒ ì‹œë‚˜ë¦¬ì˜¤ ì‹¤íŒ¨: ${error.message}`);
            }
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ì˜ˆì•½ ìƒì„± â†’ ìŠ¹ì¸ â†’ ì·¨ì†Œ
        async function reservationFlowScenario() {
            updateScenarioLog('\n1ï¸âƒ£ ì˜ˆì•½ ìƒì„± ì¤‘...');
            // ì‹¤ì œ êµ¬í˜„ì€ ê° API í˜¸ì¶œì„ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰
            await sleep(1000);
            updateScenarioLog('âœ“ ì˜ˆì•½ ìƒì„± ì™„ë£Œ (ID: 123)');
            
            updateScenarioLog('\n2ï¸âƒ£ ê´€ë¦¬ì ìŠ¹ì¸ ì¤‘...');
            await sleep(1000);
            updateScenarioLog('âœ“ ìŠ¹ì¸ ì™„ë£Œ');
            
            updateScenarioLog('\n3ï¸âƒ£ ì‚¬ìš©ì ì·¨ì†Œ ì¤‘...');
            await sleep(1000);
            updateScenarioLog('âœ“ ì·¨ì†Œ ì™„ë£Œ');
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 2: ì˜ˆì•½ ìƒì„± â†’ ë°˜ë ¤
        async function reservationRejectScenario() {
            updateScenarioLog('\n1ï¸âƒ£ ì˜ˆì•½ ìƒì„± ì¤‘...');
            await sleep(1000);
            updateScenarioLog('âœ“ ì˜ˆì•½ ìƒì„± ì™„ë£Œ');
            
            updateScenarioLog('\n2ï¸âƒ£ ê´€ë¦¬ì ë°˜ë ¤ ì¤‘...');
            await sleep(1000);
            updateScenarioLog('âœ“ ë°˜ë ¤ ì™„ë£Œ (ì‚¬ìœ : ì‹œì„¤ ì ê²€)');
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 3: ëª¨ë“  ìƒíƒœ ì „í™˜
        async function statusTransitionScenario() {
            const statuses = ['PENDING', 'APPROVED', 'COMPLETED', 'CANCELLED'];
            for (const status of statuses) {
                updateScenarioLog(`\nğŸ”„ ìƒíƒœ ë³€ê²½: ${status}`);
                await sleep(500);
                updateScenarioLog(`âœ“ ${status} ì „í™˜ ì„±ê³µ`);
            }
        }

        // ì‹œë‚˜ë¦¬ì˜¤ 4: ìŠ¹ì¸ í›„ ì·¨ì†Œ
        async function cancelAfterApproveScenario() {
            updateScenarioLog('\n1ï¸âƒ£ ì˜ˆì•½ ìƒì„± â†’ ìŠ¹ì¸');
            await sleep(1000);
            updateScenarioLog('âœ“ ìŠ¹ì¸ ì™„ë£Œ');
            
            updateScenarioLog('\n2ï¸âƒ£ ìŠ¹ì¸ëœ ì˜ˆì•½ ì·¨ì†Œ ì‹œë„...');
            await sleep(1000);
            updateScenarioLog('âš ï¸ ì·¨ì†Œ ì •ì±… í™•ì¸: ìŠ¹ì¸ëœ ì˜ˆì•½ë„ ì·¨ì†Œ ê°€ëŠ¥í•œì§€ ê²€ì¦');
            await sleep(500);
            updateScenarioLog('âœ“ ì·¨ì†Œ ì„±ê³µ (ë˜ëŠ” ì •ì±…ì— ë”°ë¼ ì‹¤íŒ¨)');
        }

        // ìœ í‹¸ë¦¬í‹°
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function updateScenarioLog(text) {
            const log = document.getElementById('scenarioLog');
            log.textContent += text + '\n';
            log.scrollTop = log.scrollHeight;
        }

        function updateResponse(text) {
            document.getElementById('response').textContent = text;
        }

        function clearResponse() {
            document.getElementById('response').textContent = 'ì—¬ê¸°ì— API ì‘ë‹µì´ í‘œì‹œë©ë‹ˆë‹¤...';
        }

        function updateTokenInfo() {
            const tokenInfo = document.getElementById('tokenInfo');
            const userInfo = document.getElementById('userInfo');
            const tokenExpiry = document.getElementById('tokenExpiry');
            
            if (accessToken) {
                tokenInfo.style.display = 'block';
                const user = JSON.parse(localStorage.getItem('userInfo') || '{}');
                userInfo.textContent = user.email || 'ì •ë³´ ì—†ìŒ';
                
                try {
                    const payload = JSON.parse(atob(accessToken.split('.')[1]));
                    const expiry = new Date(payload.exp * 1000);
                    tokenExpiry.textContent = expiry.toLocaleString('ko-KR');
                } catch (e) {
                    tokenExpiry.textContent = 'íŒŒì‹± ì‹¤íŒ¨';
                }
            } else {
                tokenInfo.style.display = 'none';
            }
        }
    </script>
</body>
</html>
