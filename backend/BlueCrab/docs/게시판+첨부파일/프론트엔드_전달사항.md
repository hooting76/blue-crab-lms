# 프론트엔드 팀 전달 사항 - 게시글 & 첨부파일 API

## 📢 전달 개요

**날짜**: 2025년 10월 3일  
**담당**: 백엔드 개발팀 (성태준)  
**상태**: ✅ 모든 API 구현 완료 (100%)

---

## ✅ 구현 완료 확인

### 백엔드 API 구현 상태
- ✅ 게시글 목록/상세 조회 API
- ✅ 게시글 작성 API
- ✅ 첨부파일 업로드 API (다중 파일)
- ✅ 첨부파일 연결 API
- ✅ 첨부파일 다운로드 API (브라우저 자동 처리)
- ✅ 첨부파일 삭제 API (통합: 단일/다중 모두 처리, 게시글별 전체 삭제)
- ✅ 첨부파일 정보 조회 API

**총 11개 API 엔드포인트 준비 완료**

---

## 📚 문서 안내

### 1. 빠른 시작 (추천)
👉 **`프론트엔드_Quick_Start.md`**
- 5분 안에 API 사용법 파악
- 복사 가능한 코드 예제
- React 컴포넌트 샘플

### 2. 상세 가이드
👉 **`프론트엔드_최신_연동_가이드_v2.md`**
- 전체 API 명세서
- 요청/응답 상세 예제
- 에러 처리 가이드
- 플로우차트

### 3. 백엔드 구현 현황
👉 **`게시글_첨부파일_구현_계획.md`**
- 구현 완료 현황
- 기술 스택 정보
- MinIO 저장 구조

---

## 🎯 반드시 알아야 할 핵심 사항

### 1️⃣ 3단계 워크플로우 필수!

게시글 + 첨부파일 작성 시:

```
1단계: 게시글 생성
  ↓
2단계: 파일 업로드 (선택사항)
  ↓
3단계: 첨부파일 연결
```

**중요**: 각 단계를 순차적으로 실행해야 합니다.

---

### 2️⃣ 파일 업로드는 FormData만 가능!

❌ **잘못된 방법** (JSON):
```javascript
// 이렇게 하면 안 됩니다!
body: JSON.stringify({ files: files })
```

✅ **올바른 방법** (FormData):
```javascript
const formData = new FormData();
files.forEach(file => formData.append('files', file));
body: formData
```

---

### 3️⃣ 다운로드는 브라우저가 자동 처리

서버가 `Content-Disposition: attachment` 헤더를 보내므로:
- 브라우저가 자동으로 다운로드 대화상자 표시
- 원본 파일명으로 자동 저장 (한글 지원)
- 별도 UI 처리 불필요

**구현 방법**:
```javascript
// fetch로 blob 받아서 다운로드 링크 생성
const blob = await response.blob();
const url = window.URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = fileName;
a.click();
```

---

### 4️⃣ JWT 인증 필요/불필요 구분

**JWT 필요** (Authorization 헤더):
- 게시글 작성
- 파일 업로드
- 파일 연결
- 파일 삭제

**JWT 불필요**:
- 게시글 목록/상세 조회
- 파일 다운로드
- 파일 정보 조회

---

### 5️⃣ 파일 제한사항

| 항목 | 제한 |
|-----|------|
| 최대 개수 | 5개/게시글 |
| 최대 크기 | 10MB/파일 |
| 허용 형식 | PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, TXT, JPG, JPEG, PNG, GIF |

---

## 🔧 필수 구현 체크리스트

### 게시글 작성 페이지
- [ ] 제목/내용 입력 폼
- [ ] 파일 선택 input (multiple, max 5개)
- [ ] 파일 크기 검증 (10MB)
- [ ] 파일 개수 검증 (5개)
- [ ] 3단계 API 순차 호출
- [ ] 로딩 상태 표시
- [ ] 에러 처리 및 사용자 피드백

### 게시글 상세 페이지
- [ ] 게시글 정보 표시
- [ ] 첨부파일 목록 표시 (attachmentDetails 배열)
- [ ] 파일 다운로드 버튼
- [ ] 파일명, 크기 표시
- [ ] 다운로드 클릭 시 브라우저 다운로드

### 게시글 목록 페이지
- [ ] 페이징 처리
- [ ] 코드별 필터링 (선택사항)
- [ ] 게시글 클릭 시 상세 페이지 이동

---

## 🧪 테스트 시나리오

### 시나리오 1: 첨부파일 없는 게시글
1. 게시글 작성 (제목, 내용만)
2. 파일 선택 안 함
3. 제출 → 1단계만 실행
4. 상세 페이지에서 첨부파일 없음 확인

### 시나리오 2: 첨부파일 1개 포함
1. 게시글 작성 (제목, 내용)
2. 파일 1개 선택
3. 제출 → 3단계 모두 실행
4. 상세 페이지에서 파일 1개 표시 확인
5. 다운로드 버튼 클릭 → 파일 다운로드 확인

### 시나리오 3: 첨부파일 5개 포함
1. 파일 5개 선택
2. 3단계 API 정상 실행 확인
3. 상세 페이지에서 파일 5개 모두 표시
4. 각 파일 다운로드 테스트

### 시나리오 4: 파일 제한 테스트
1. 6개 파일 선택 시도 → 에러 메시지
2. 11MB 파일 선택 시도 → 에러 메시지
3. 허용되지 않은 형식 선택 → 에러 메시지

---

## 📊 API 응답 예제 (빠른 참조)

### 게시글 상세 조회 응답
```json
{
  "boardIdx": 123,
  "boardTitle": "제목",
  "boardContent": "내용",
  "boardWriter": "작성자",
  "attachmentDetails": [
    {
      "attachmentIdx": 45,
      "originalFileName": "문서.pdf",
      "fileSize": 1024000,
      "mimeType": "application/pdf"
    }
  ]
}
```

### 파일 업로드 응답
```json
{
  "success": true,
  "attachments": [
    {
      "attachmentIdx": 45,
      "originalFileName": "문서.pdf",
      "fileSize": 1024000
    }
  ]
}
```

---

## ⚠️ 주의사항

### 1. Content-Type 헤더
- **JSON 전송**: `'Content-Type': 'application/json'`
- **파일 업로드**: Content-Type 헤더 생략 (FormData가 자동 설정)

### 2. 에러 처리
- 401 Unauthorized → 로그인 페이지로 리다이렉트
- 404 Not Found → "게시글을 찾을 수 없습니다" 메시지
- 410 Gone → "삭제된 파일입니다" 메시지

### 3. 파일명 인코딩
- 한글 파일명 지원 (서버에서 처리 완료)
- 특수문자 포함 파일명 지원

---

## 🆘 문제 발생 시

### API 호출 실패
1. 네트워크 탭에서 요청/응답 확인
2. JWT 토큰 유효성 확인
3. 요청 Body 형식 확인 (JSON vs FormData)

### 파일 업로드 실패
1. FormData 사용 확인
2. 파일 크기/개수 제한 확인
3. Authorization 헤더 확인

### 다운로드 실패
1. attachmentIdx 값 확인
2. 브라우저 콘솔 에러 확인
3. blob 변환 과정 확인

---

## 📞 연락처

**백엔드 팀**: 성태준  
**문의 방법**: [프로젝트 채팅/이메일]

**즉시 연동 가능합니다!** 🎉

---

**전달 일시**: 2025년 10월 3일  
**API 버전**: v2.0 (완성)  
**문서 상태**: ✅ 최신
