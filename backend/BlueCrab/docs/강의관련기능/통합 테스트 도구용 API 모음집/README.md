# 📚 Blue Crab LMS - 강의 관련 API 통합 문서

## 📋 목차

1. [과제 관리 API](./01-과제관리-API.md)
2. [수강 및 성적 관리 API](./02-수강및성적-API.md)
3. [출석 관리 API (학생용)](./03-출석관리-학생용-API.md)
4. [출석 관리 API (교수용)](./04-출석관리-교수용-API.md)
5. [강의 관리 API](./05-강의관리-API.md)
6. [통합 출석 관리 API](./06-통합출석관리-API.md)
7. [공지사항 관리 API](./07-공지사항관리-API.md)

---

## 🎯 문서 활용 목적

이 API 모음집은 **통합 테스트 도구 개발**을 위해 작성되었습니다.

### 주요 활용 사례
- ✅ 브라우저 콘솔 테스트 스크립트 작성
- ✅ E2E 통합 테스트 시나리오 구성
- ✅ API 동작 검증 및 디버깅
- ✅ 프론트엔드-백엔드 연동 테스트

---

## 🔑 공통 사항

### Base URL
```
https://bluecrab.chickenkiller.com/BlueCrab-1.0.0
```

### 인증 방식
모든 API는 JWT 토큰 기반 인증을 사용합니다.

**헤더 예시:**
```http
Authorization: Bearer {accessToken}
Content-Type: application/json
```

### 응답 형식

#### 성공 응답
```json
{
  "success": true,
  "message": "작업이 성공적으로 완료되었습니다.",
  "data": { /* 응답 데이터 */ }
}
```

#### 실패 응답
```json
{
  "success": false,
  "message": "오류 메시지"
}
```

---

## 📊 API 분류

### 1. 과제 관리 (Assignment)
- 과제 생성, 조회, 수정, 삭제
- 과제 제출 및 채점
- 제출 현황 조회

### 2. 출석 관리 (Attendance)
#### 학생용
- 출석 현황 조회
- 출석 요청 생성
- 대기 중인 요청 조회

#### 교수용
- 출석 요청 승인/거부
- 출석 직접 체크
- 대기 요청 목록 조회

### 3. 수강 관리 (Enrollment)
- 수강 신청/취소
- 수강생 목록 조회
- 수강 정보 관리

### 4. 성적 관리 (Grade)
- 성적 설정/조회
- 성적 자동 재계산
- 성적 확정

### 5. 강의 관리 (Lecture)
- 강의 생성/수정/삭제
- 강의 목록 조회
- 강의 상세 정보

---

## 🔄 핵심 비즈니스 로직

### 성적 자동 재계산
출석 승인 또는 과제 채점 시 자동으로 성적이 재계산됩니다.

**트리거 이벤트:**
- ✅ 출석 승인 (`GradeUpdateEvent` 발행)
- ✅ 과제 채점 (`GradeUpdateEvent` 발행)

**재계산 로직:**
```
총점 = 출석 점수 + 과제 점수
```
> **참고**: 시험(중간고사, 기말고사)도 시스템상 과제(Assignment)로 관리되므로 과제 점수에 포함됩니다.

### 과제 점수 제한
과제 채점 시 입력된 점수가 해당 과제의 만점을 초과하면 자동으로 만점으로 조정됩니다.

**예시:**
- 과제 만점: 30점
- 입력 점수: 35점
- 실제 저장: 30점 (자동 조정)

---

## 📌 테스트 시나리오 예시

### 시나리오 1: 출석-성적 통합 테스트
1. 학생 초기 성적 확인
2. 학생이 출석 요청 생성
3. 교수가 출석 승인
4. 성적 자동 재계산 확인
5. 업데이트된 성적 검증

### 시나리오 2: 과제-성적 통합 테스트
1. 학생 초기 성적 확인
2. 교수가 과제 생성
3. 교수가 과제 채점 (오프라인 제출)
4. 성적 자동 재계산 확인
5. 업데이트된 성적 검증

---

## 🛠️ 관련 기술 스택

### Backend
- **Framework**: Spring Boot 3.x
- **Database**: MariaDB
- **ORM**: JPA/Hibernate
- **Event**: Spring ApplicationEvent
- **Transaction**: @Transactional

### Frontend Testing
- **Tool**: Browser Console (JavaScript)
- **API Client**: Fetch API
- **Format**: JSON

---

## 📝 변경 이력

### 2025-10-24
- ✅ 과제 생성 시 maxScore 파라미터 추가 (기본값 10점)
- ✅ 과제 채점 시 만점 초과 자동 조정 기능 추가
- ✅ maxScore 기반 점수 제한 로직 구현
- ✅ 성적 자동 재계산 이벤트 시스템 검증

---

## 📞 문의 및 지원

문제가 발생하거나 API 관련 질문이 있을 경우:
- 백엔드 로그 확인
- 브라우저 콘솔 에러 확인
- HTTP 상태 코드 및 응답 메시지 확인

---

**Last Updated:** 2025-10-24  
**Version:** 1.0.0
