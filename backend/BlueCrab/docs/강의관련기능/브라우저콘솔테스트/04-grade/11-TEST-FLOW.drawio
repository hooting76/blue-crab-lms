<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36" version="28.2.7">
  <diagram name="테스트플로우" id="test-flow">
    <mxGraphModel dx="1426" dy="777" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1100" background="light-dark(#FFFFFF,#FFFFFF)" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="🎓 성적 관리 시스템 - 브라우저 콘솔 테스트 플로우" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=light-dark(#000000,#000000);" parent="1" vertex="1">
          <mxGeometry x="300" y="20" width="800" height="40" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="📊 7개 API 테스트 (Phase 1: 5개 + Phase 3: 2개) - lecSerial + studentIdx 통합 구조" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontColor=light-dark(#000000,#000000);labelBackgroundColor=none;" parent="1" vertex="1">
          <mxGeometry x="350" y="60" width="700" height="20" as="geometry" />
        </mxCell>
        <mxCell id="module-title" value="📦 테스트 파일 구조 (2개) - 각각 독립 실행 가능 ✅" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=light-dark(#000000,#000000);" parent="1" vertex="1">
          <mxGeometry x="40" y="100" width="550" height="30" as="geometry" />
        </mxCell>
        <mxCell id="module1" value="📦 01-grade-phase1-tests.js&#xa;&#xa;🎯 Phase 1 - 독립 실행 (~580줄)&#xa;✅ 5개 핵심 기능 테스트&#xa;✅ lecSerial + studentIdx 통일&#xa;✅ JWT 인증 + 권한 검증&#xa;&#xa;▪ gradePhase1.config()&#xa;▪ gradePhase1.studentInfo()&#xa;▪ gradePhase1.professorView()&#xa;▪ gradePhase1.gradeList()&#xa;▪ gradePhase1.finalize()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=3;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="40" y="140" width="320" height="180" as="geometry" />
        </mxCell>
        <mxCell id="module2" value="📦 02-grade-phase3-tests.js&#xa;&#xa;⚡ Phase 3 - 독립 실행 (~440줄)&#xa;✅ 2개 이벤트 시스템 테스트&#xa;✅ lecSerial + studentIdx 통일&#xa;✅ enrollmentIdx 자동 조회 ⭐&#xa;✅ JWT 인증 + 권한 검증&#xa;&#xa;▪ gradePhase3.listStudents() ⭐ NEW&#xa;▪ gradePhase3.attendance()&#xa;▪ gradePhase3.assignment()&#xa;▪ Before/After 자동 비교" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=3;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="420" y="140" width="320" height="180" as="geometry" />
        </mxCell>
        <mxCell id="7sI1dyFYDF2QiaqFFNdB-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="module3" target="module2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="module3" value="📦 03-grade-test-runner.js&#xa;&#xa;🚀 통합 러너 - 선택사항 (250줄)&#xa;✅ Phase 1 + 3 통합 실행&#xa;✅ 편의 기능만 제공&#xa;&#xa;▪ gradeRunner.setup()&#xa;▪ gradeRunner.phase1()&#xa;▪ gradeRunner.phase3()&#xa;▪ gradeRunner.runAll()&#xa;▪ 바로가기 함수들" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fa6800;strokeColor=#C73500;strokeWidth=3;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;dashed=1;dashPattern=8 8;" parent="1" vertex="1">
          <mxGeometry x="800" y="140" width="280" height="180" as="geometry" />
        </mxCell>
        <mxCell id="phase1-title" value="🎯 Phase 1: 핵심 기능 테스트 (5개) - lecSerial + JWT 인증 🔐" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=light-dark(#000000,#000000);" parent="1" vertex="1">
          <mxGeometry x="40" y="340" width="600" height="30" as="geometry" />
        </mxCell>
        <mxCell id="test1" value="1️⃣ 성적 구성 설정&#xa;&#xa;📡 POST /lectures/{lecSerial}/grade-config&#xa;&#xa;✓ 출석/과제 배점&#xa;✓ 등급 분포 (A+~D)&#xa;✓ 지각 페널티 설정&#xa;✓ JWT 교수 권한 검증&#xa;&#xa;▶ gradePhase1.config()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="40" y="390" width="180" height="160" as="geometry" />
        </mxCell>
        <mxCell id="test2" value="2️⃣ 학생 성적 조회&#xa;&#xa;📡 GET /lectures/{lecSerial}/&#xa;    students/{email}/grade&#xa;&#xa;✓ 출석 점수 (출석율, 지각)&#xa;✓ 과제 점수 (개별, 총점)&#xa;✓ 총점, 백분율&#xa;&#xa;▶ gradePhase1.studentInfo()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="250" y="390" width="180" height="160" as="geometry" />
        </mxCell>
        <mxCell id="test3" value="3️⃣ 교수용 성적 조회&#xa;&#xa;📡 GET /lectures/{lecSerial}/&#xa;    professor/grade&#xa;&#xa;✓ 학생 정보 + 통계&#xa;✓ 반 평균, 최고점&#xa;✓ 순위 정보&#xa;&#xa;▶ gradePhase1.professorView()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="460" y="390" width="180" height="160" as="geometry" />
        </mxCell>
        <mxCell id="test4" value="4️⃣ 성적 목록 조회&#xa;&#xa;📡 GET /lectures/{lecSerial}/&#xa;    grade-list&#xa;&#xa;✓ 전체 수강생 목록&#xa;✓ 정렬 (점수, 이름)&#xa;✓ 페이징 처리&#xa;&#xa;▶ gradePhase1.gradeList()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fa6800;strokeColor=#C73500;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="670" y="390" width="180" height="160" as="geometry" />
        </mxCell>
        <mxCell id="test5" value="5️⃣ 최종 등급 배정&#xa;&#xa;📡 POST /lectures/{lecSerial}/&#xa;     finalize-grades&#xa;&#xa;✓ 60% 기준 F등급 분류&#xa;✓ 상대평가 (A+~D)&#xa;✓ 하위 침범 알고리즘&#xa;✓ 동점자 상위등급 배정&#xa;&#xa;▶ gradePhase1.finalize()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="880" y="390" width="180" height="170" as="geometry" />
        </mxCell>
        <mxCell id="phase3-title" value="⚡ Phase 3: 이벤트 시스템 테스트 (2개) - enrollmentIdx 자동 조회 ⭐" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=light-dark(#000000,#000000);" parent="1" vertex="1">
          <mxGeometry x="40" y="590" width="700" height="30" as="geometry" />
        </mxCell>
        <mxCell id="test6" value="6️⃣ 출석 업데이트 + 이벤트&#xa;&#xa;📡 PUT /enrollments/{enrollmentIdx}/attendance&#xa;   (enrollmentIdx 자동 조회 ⭐)&#xa;&#xa;✓ 출석/지각/결석 기록&#xa;✓ GradeUpdateEvent 발행&#xa;✓ 비동기 성적 재계산&#xa;✓ Before/After 점수 비교&#xa;&#xa;▶ gradePhase3.testAttendanceUpdate()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;strokeColor=#006EAF;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="40" y="640" width="250" height="200" as="geometry" />
        </mxCell>
        <mxCell id="test7" value="7️⃣ 과제 채점 + 이벤트&#xa;&#xa;📡 PUT /assignments/{assignmentIdx}/grade&#xa;   (lecSerial + studentIdx 기반)&#xa;&#xa;✓ 과제 점수 입력&#xa;✓ GradeUpdateEvent 발행&#xa;✓ 비동기 성적 재계산&#xa;✓ Before/After 총점 비교&#xa;&#xa;▶ gradePhase3.testAssignmentGrade()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=8;spacingTop=8;" parent="1" vertex="1">
          <mxGeometry x="320" y="640" width="250" height="200" as="geometry" />
        </mxCell>
        <mxCell id="event-box" value="⚙️ 이벤트 기반 자동 재계산 시스템&#xa;&#xa;① 출석/과제 변경 감지&#xa;   → AttendanceController&#xa;   → AssignmentController&#xa;   ✅ JWT 토큰 검증&#xa;&#xa;② GradeUpdateEvent 발행&#xa;   → ApplicationEventPublisher&#xa;&#xa;③ EventListener 비동기 처리&#xa;   → @EventListener @Async&#xa;   → GradeUpdateEventListener&#xa;&#xa;④ 해당 학생 성적만 재계산&#xa;   → GradeCalculationService&#xa;   → lecIdx + studentIdx 기반&#xa;   → enrollmentIdx 자동 조회 ⭐&#xa;&#xa;⑤ ENROLLMENT_DATA 업데이트&#xa;   → JSON 선택적 업데이트" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=3;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;dashed=1;dashPattern=8 8;spacingLeft=10;spacingTop=10;" parent="1" vertex="1">
          <mxGeometry x="600" y="640" width="300" height="320" as="geometry" />
        </mxCell>
        <mxCell id="execution-title" value="🚀 실행 방법 - 각 파일 독립 실행 ✅" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=light-dark(#000000,#000000);" parent="1" vertex="1">
          <mxGeometry x="40" y="950" width="450" height="30" as="geometry" />
        </mxCell>
        <mxCell id="exec1" value="🎯 Phase 1 실행&#xa;&#xa;gradePhase1.setLecture(&#xa;  &#39;ETH201&#39;, // lecSerial&#xa;  6           // studentIdx&#xa;)&#xa;await gradePhase1.runAll()&#xa;&#xa;➜ 5개 테스트&#xa;➜ 10-15초 소요" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#008a00;strokeColor=#005700;strokeWidth=2;fontSize=11;fontStyle=1;fontColor=#ffffff;spacingLeft=8;spacingTop=8;align=left;" parent="1" vertex="1">
          <mxGeometry x="40" y="990" width="220" height="170" as="geometry" />
        </mxCell>
        <mxCell id="exec2" value="⚡ Phase 3 실행&#xa;&#xa;// 학생 목록 조회 (선택) ⭐&#xa;await gradePhase3.listStudents()&#xa;&#xa;gradePhase3.setLecture(&#xa;  &#39;ETH201&#39;, // lecSerial&#xa;  6,          // studentIdx&#xa;  1           // assignmentIdx&#xa;)&#xa;await gradePhase3.runAll()&#xa;&#xa;➜ 2개 테스트&#xa;➜ 5-10초 소요&#xa;➜ enrollmentIdx 자동 조회 ⭐" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;fontSize=11;fontStyle=1;fontColor=#ffffff;spacingLeft=8;spacingTop=8;align=left;" parent="1" vertex="1">
          <mxGeometry x="290" y="990" width="250" height="250" as="geometry" />
        </mxCell>
        <mxCell id="exec3" value="🚀 통합 실행 (선택)&#xa;&#xa;gradeRunner.setup(&#xa;  &#39;ETH201&#39;,   // lecSerial&#xa;  6,            // studentIdx&#xa;  1             // assignmentIdx&#xa;)&#xa;await gradeRunner.runAll()&#xa;&#xa;➜ Phase 1+3 통합&#xa;➜ 15-25초 소요" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;fontSize=11;align=left;fontColor=#ffffff;spacingLeft=8;spacingTop=8;dashed=1;dashPattern=8 8;" parent="1" vertex="1">
          <mxGeometry x="570" y="990" width="220" height="200" as="geometry" />
        </mxCell>
        <mxCell id="result-box" value="✅ 예상 결과&#xa;&#xa;━━━━━━━━━━━━━━━━━&#xa;총 테스트: 7개&#xa;✓ 성공: 7개&#xa;✗ 실패: 0개&#xa;📊 성공률: 100.0%&#xa;━━━━━━━━━━━━━━━━━&#xa;&#xa;📝 상세 결과:&#xa;   1. 성적 구성 설정 ✅&#xa;   2. 학생 성적 조회 ✅&#xa;   3. 교수용 성적 조회 ✅&#xa;   4. 성적 목록 조회 ✅&#xa;   5. 최종 등급 배정 ✅&#xa;   6. 출석 업데이트 ✅&#xa;   7. 과제 채점 ✅&#xa;&#xa;━━━━━━━━━━━━━━━━━&#xa;🔐 JWT 토큰 인증&#xa;✅ lecSerial 권한 검증&#xa;✅ enrollmentIdx 자동 조회 ⭐&#xa;✅ 서버 이벤트 처리" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fa6800;strokeColor=#C73500;strokeWidth=3;fontSize=11;align=left;verticalAlign=top;fontColor=#ffffff;spacingLeft=10;spacingTop=10;" parent="1" vertex="1">
          <mxGeometry x="930" y="640" width="240" height="360" as="geometry" />
        </mxCell>
        <mxCell id="flow-arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#9673A6;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;fontColor=#000000;" parent="1" source="test1" target="test2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="220" y="440" as="sourcePoint" />
            <mxPoint x="250" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow2" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#82B366;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;fontColor=#000000;" parent="1" source="test2" target="test3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="430" y="440" as="sourcePoint" />
            <mxPoint x="460" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow3" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#D6B656;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;fontColor=#000000;" parent="1" source="test3" target="test4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="640" y="440" as="sourcePoint" />
            <mxPoint x="670" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow4" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#D79B00;edgeStyle=orthogonalEdgeStyle;fontColor=#000000;exitX=0.997;exitY=0.462;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="test4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="850" y="440" as="sourcePoint" />
            <mxPoint x="880" y="464" as="targetPoint" />
            <Array as="points">
              <mxPoint x="880" y="464" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="event-arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#6C8EBF;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;fontColor=#000000;" parent="1" source="test6" target="test7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="260" y="695" as="sourcePoint" />
            <mxPoint x="300" y="695" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="data-flow" value="💾 테스트 설정 - lecSerial + studentIdx 통일 🔐" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=light-dark(#000000,#000000);" parent="1" vertex="1">
          <mxGeometry x="40" y="1280" width="550" height="30" as="geometry" />
        </mxCell>
        <mxCell id="data-box" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;📋 Phase 1 config = {&#xa;  // 식별자 (lecSerial + studentIdx)&#xa;  lecSerial: &#39;ETH201&#39;,&#xa;  studentIdx: 6,&#xa;  &#xa;  // 성적 설정&#xa;  passingThreshold: 60.0,&#xa;  attendanceMaxScore: 80,&#xa;  assignmentTotalMaxScore: 100,&#xa;  latePenaltyPerSession: 0.5,&#xa;  &#xa;  // 등급 분포&#xa;  gradeDistribution: {&#xa;    &#39;A+&#39;: 10, &#39;A&#39;: 15,&#xa;    &#39;B+&#39;: 20, &#39;B&#39;: 25,&#xa;    &#39;C&#39;: 20, &#39;D&#39;: 10&#xa;  }&#xa;}&#xa;&#xa;� Phase 3 config = {&#xa;  // 식별자 (lecSerial + studentIdx)&#xa;  lecSerial: &#39;ETH201&#39;,&#xa;  studentIdx: 6,&#xa;  assignmentIdx: 1,&#xa;  &#xa;  // enrollmentIdx 자동 조회 ⭐&#xa;  enrollmentIdx: null  // 자동 설정됨&#xa;}&#xa;&#xa;�🔐 JWT 토큰:&#xa;  window.authToken&#xa;  (login()에서 설정)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;strokeColor=#2D7600;strokeWidth=2;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;fontColor=#ffffff;spacingLeft=10;spacingTop=10;" parent="1" vertex="1">
          <mxGeometry x="40" y="1320" width="360" height="490" as="geometry" />
        </mxCell>
        <mxCell id="modify-box" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;🔧 설정 변경&#xa;&#xa;━━━━━━━━━━━━━━━━━━━━━━&#xa;// Phase 1&#xa;gradePhase1.setLecture(&#xa;  &#39;ETH201&#39;,  // lecSerial&#xa;  6           // studentIdx&#xa;)&#xa;━━━━━━━━━━━━━━━━━━━━━━&#xa;&#xa;// Phase 3&#xa;gradePhase3.setLecture(&#xa;  &#39;ETH201&#39;,   // lecSerial&#xa;  6,           // studentIdx&#xa;  1            // assignmentIdx&#xa;)&#xa;// → enrollmentIdx 자동 조회됨 ⭐&#xa;━━━━━━━━━━━━━━━━━━━━━━&#xa;&#xa;// 학생 목록 조회 (Phase 3) ⭐&#xa;await gradePhase3.listStudents()&#xa;// → studentIdx 확인 가능&#xa;━━━━━━━━━━━━━━━━━━━━━━&#xa;&#xa;// 설정 확인&#xa;gradePhase1.getConfig()&#xa;gradePhase3.getConfig()&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;strokeColor=#006EAF;strokeWidth=2;fontSize=10;align=left;fontColor=#ffffff;spacingLeft=10;spacingTop=10;" parent="1" vertex="1">
          <mxGeometry x="420" y="1320" width="340" height="490" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
