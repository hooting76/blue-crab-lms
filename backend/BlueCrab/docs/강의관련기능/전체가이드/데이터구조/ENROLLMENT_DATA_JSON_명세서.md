# ENROLLMENT_EXTENDED_TBL.ENROLLMENT_DATA JSON êµ¬ì¡° ëª…ì„¸ì„œ

## ğŸ“‹ ê°œìš”

`ENROLLMENT_EXTENDED_TBL` í…Œì´ë¸”ì˜ `ENROLLMENT_DATA` ì»¬ëŸ¼ì€ **LONGTEXT** íƒ€ì…ìœ¼ë¡œ ìˆ˜ê°•ì‹ ì²­, ì¶œê²°, ì„±ì  ê´€ë ¨ ëª¨ë“  ì •ë³´ë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

---

## ğŸ—ï¸ ì „ì²´ JSON êµ¬ì¡°

```json
{
  "version": "2.0",
  "enrollment": { ... },
  "attendance": { ... },
  "gradeConfig": { ... },
  "grade": { ... }
}
```

---

## ğŸ“Š 1. enrollment (ìˆ˜ê°•ì‹ ì²­ ì •ë³´)

ìˆ˜ê°•ì‹ ì²­ ìƒíƒœ ë° ì´ë ¥ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.

```json
{
  "enrollment": {
    "status": "ENROLLED",                    // ìˆ˜ê°• ìƒíƒœ
    "enrollmentDate": "2025-03-01T09:00:00", // ìˆ˜ê°•ì‹ ì²­ì¼
    "cancelDate": null,                      // ì·¨ì†Œì¼ (nullable)
    "cancelReason": null                     // ì·¨ì†Œ ì‚¬ìœ  (nullable)
  }
}
```

### ğŸ“ í•„ë“œ ì„¤ëª…

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… | ê°€ëŠ¥í•œ ê°’ |
|--------|------|------|-----------|
| `status` | String | ìˆ˜ê°• ìƒíƒœ | `ENROLLED`, `CANCELLED`, `COMPLETED` |
| `enrollmentDate` | String (ISO DateTime) | ìˆ˜ê°•ì‹ ì²­ì¼ì‹œ | `2025-03-01T09:00:00` |
| `cancelDate` | String (ISO DateTime) | ìˆ˜ê°• ì·¨ì†Œì¼ì‹œ | `null` ë˜ëŠ” ë‚ ì§œ |
| `cancelReason` | String | ìˆ˜ê°• ì·¨ì†Œ ì‚¬ìœ  | `null` ë˜ëŠ” í…ìŠ¤íŠ¸ |

---

## ğŸ“… 2. attendance (ì¶œê²° ì •ë³´)

ì¶œì„ ìš”ì²­/ìŠ¹ì¸ ì‹œìŠ¤í…œì˜ í•µì‹¬ ë°ì´í„° êµ¬ì¡°ì…ë‹ˆë‹¤.

### 2.1 ì „ì²´ êµ¬ì¡°

```json
{
  "attendance": {
    "summary": { ... },        // ì¶œì„ í†µê³„ ìš”ì•½
    "sessions": [ ... ],       // í™•ì •ëœ ì¶œì„ ê¸°ë¡ (ìµœëŒ€ 80ê°œ)
    "pendingRequests": [ ... ] // ëŒ€ê¸° ì¤‘ì¸ ì¶œì„ ìš”ì²­ (ìµœëŒ€ 80ê°œ)
  }
}
```

### 2.2 summary (ì¶œì„ í†µê³„)

```json
{
  "summary": {
    "attended": 30,                         // ì¶œì„ íšŸìˆ˜
    "late": 5,                             // ì§€ê° íšŸìˆ˜
    "absent": 5,                           // ê²°ì„ íšŸìˆ˜
    "totalSessions": 40,                   // ì´ ì§„í–‰ëœ íšŒì°¨
    "attendanceRate": 75.0,                // ì¶œì„ìœ¨ (%)
    "updatedAt": "2025-10-20 15:51:09"     // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸
  }
}
```

**ğŸ“ í•„ë“œ ì„¤ëª…:**

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… | ê³„ì‚° ë°©ì‹ |
|--------|------|------|-----------|
| `attended` | Integer | ì¶œì„ íšŸìˆ˜ | sessionsì—ì„œ `status: "ì¶œ"` ê°œìˆ˜ |
| `late` | Integer | ì§€ê° íšŸìˆ˜ | sessionsì—ì„œ `status: "ì§€"` ê°œìˆ˜ |
| `absent` | Integer | ê²°ì„ íšŸìˆ˜ | sessionsì—ì„œ `status: "ê²°"` ê°œìˆ˜ |
| `totalSessions` | Integer | ì´ ì§„í–‰ íšŒì°¨ | sessions ë°°ì—´ ê¸¸ì´ |
| `attendanceRate` | Float | ì¶œì„ìœ¨ | `(attended / totalSessions) * 100` |
| `updatedAt` | String | ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ | ìë™ ìƒì„± |

### 2.3 sessions (í™•ì •ëœ ì¶œì„ ê¸°ë¡)

í•™ìƒì˜ ì¶œì„ ìš”ì²­ì´ êµìˆ˜ì— ì˜í•´ ìŠ¹ì¸ë˜ê±°ë‚˜ ìë™ ìŠ¹ì¸ëœ ê¸°ë¡ë“¤ì…ë‹ˆë‹¤.

```json
{
  "sessions": [
    {
      "sessionNumber": 1,                     // ê°•ì˜ íšŒì°¨ (1~80)
      "status": "ì¶œ",                         // ì¶œì„ ìƒíƒœ
      "requestDate": "2025-10-22T10:00:00",   // ìš”ì²­ì¼ì‹œ
      "approvedDate": "2025-10-22T10:30:00",  // ìŠ¹ì¸ì¼ì‹œ
      "approvedBy": 123,                      // ìŠ¹ì¸ì ID (êµìˆ˜)
      "tempApproved": false                   // ì„ì‹œ ìŠ¹ì¸ ì—¬ë¶€
    },
    {
      "sessionNumber": 2,
      "status": "ì§€",
      "requestDate": "2025-10-22T14:00:00",
      "approvedDate": "2025-10-22T14:15:00",
      "approvedBy": 123,
      "tempApproved": false
    }
  ]
}
```

**ğŸ“ í•„ë“œ ì„¤ëª…:**

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… | ê°€ëŠ¥í•œ ê°’ |
|--------|------|------|-----------|
| `sessionNumber` | Integer | ê°•ì˜ íšŒì°¨ ë²ˆí˜¸ | 1 ~ 80 |
| `status` | String | ì¶œì„ ìƒíƒœ | `"ì¶œ"`, `"ì§€"`, `"ê²°"` |
| `requestDate` | String (ISO DateTime) | í•™ìƒ ìš”ì²­ì¼ì‹œ | `2025-10-22T10:00:00` |
| `approvedDate` | String (ISO DateTime) | êµìˆ˜ ìŠ¹ì¸ì¼ì‹œ | `2025-10-22T10:30:00` |
| `approvedBy` | Integer | ìŠ¹ì¸ì ID | êµìˆ˜ì˜ USER_IDX |
| `tempApproved` | Boolean | ì„ì‹œ ìŠ¹ì¸ ì—¬ë¶€ | `false` (í™•ì • ìƒíƒœ) |

### 2.4 pendingRequests (ëŒ€ê¸° ì¤‘ì¸ ì¶œì„ ìš”ì²­)

í•™ìƒì´ ì¶œì„ ìš”ì²­í–ˆì§€ë§Œ ì•„ì§ êµìˆ˜ ìŠ¹ì¸ì´ ì—†ëŠ” ì„ì‹œ ìŠ¹ì¸ ìƒíƒœì˜ ìš”ì²­ë“¤ì…ë‹ˆë‹¤.

```json
{
  "pendingRequests": [
    {
      "sessionNumber": 3,                     // ê°•ì˜ íšŒì°¨ (1~80)
      "requestDate": "2025-10-22T16:00:00",   // ìš”ì²­ì¼ì‹œ
      "expiresAt": "2025-10-29T16:00:00",     // ë§Œë£Œì¼ì‹œ (7ì¼ í›„)
      "tempApproved": true                    // ì„ì‹œ ìŠ¹ì¸ ìƒíƒœ
    }
  ]
}
```

**ğŸ“ í•„ë“œ ì„¤ëª…:**

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… | ê³„ì‚° ë°©ì‹ |
|--------|------|------|-----------|
| `sessionNumber` | Integer | ê°•ì˜ íšŒì°¨ ë²ˆí˜¸ | 1 ~ 80 |
| `requestDate` | String (ISO DateTime) | í•™ìƒ ìš”ì²­ì¼ì‹œ | ìš”ì²­ ì‹œì  |
| `expiresAt` | String (ISO DateTime) | ìë™ ìŠ¹ì¸ ë§Œë£Œì¼ | `requestDate + 7ì¼` |
| `tempApproved` | Boolean | ì„ì‹œ ìŠ¹ì¸ ì—¬ë¶€ | `true` (ëŒ€ê¸° ìƒíƒœ) |

---

## ğŸ¯ 3. gradeConfig (ì„±ì  ì„¤ì •)

êµìˆ˜ê°€ ì„¤ì •í•œ ê°•ì˜ë³„ ì„±ì  êµ¬ì„± ë° ì •ì±…ì…ë‹ˆë‹¤.

```json
{
  "gradeConfig": {
    "attendanceMaxScore": 20,                // ì¶œì„ ë§Œì 
    "assignmentTotalScore": 50,              // ê³¼ì œ ì´ì 
    "examTotalScore": 30,                    // ì‹œí—˜ ì´ì 
    "latePenaltyPerSession": 0.5,            // ì§€ê° ê°ì  (íšŒë‹¹)
    "gradeDistribution": {                   // ë“±ê¸‰ ë¶„í¬ (%)
      "A": 30,
      "B": 40,
      "C": 20,
      "D": 10
    },
    "totalMaxScore": 100,                    // ì´ ë§Œì 
    "configuredAt": "2025-10-22T10:00:00"   // ì„¤ì •ì¼ì‹œ
  }
}
```

---

## ğŸ“Š 4. grade (ì„±ì  ì •ë³´)

ê³„ì‚°ëœ ì„±ì  ë° í‰ê°€ ê²°ê³¼ì…ë‹ˆë‹¤.

### 4.1 ì „ì²´ êµ¬ì¡°

```json
{
  "grade": {
    "attendance": { ... },    // ì¶œì„ ì ìˆ˜
    "assignments": [ ... ],   // ê³¼ì œ ì ìˆ˜ë“¤
    "total": { ... },         // ì´ì 
    "letterGrade": "A",       // ìµœì¢… ë“±ê¸‰
    "finalizedAt": "..."      // í™•ì •ì¼ì‹œ
  }
}
```

### 4.2 ì¶œì„ ì ìˆ˜ (grade.attendance)

```json
{
  "attendance": {
    "maxScore": 20,           // ë§Œì 
    "currentScore": 18.5,     // í˜„ì¬ ì ìˆ˜
    "rate": 92.5,            // ì¶œì„ìœ¨ (%)
    "lateCount": 2,          // ì§€ê° íšŸìˆ˜
    "latePenalty": 1.0,      // ì§€ê° ê°ì 
    "percentage": 92.5       // ë°±ë¶„ìœ¨
  }
}
```

### 4.3 ê³¼ì œ ì ìˆ˜ (grade.assignments)

```json
{
  "assignments": [
    {
      "name": "ê³¼ì œ1",         // ê³¼ì œëª…
      "score": 9,             // íšë“ ì ìˆ˜
      "maxScore": 10,         // ë§Œì 
      "submitted": true,      // ì œì¶œ ì—¬ë¶€
      "percentage": 90.0      // ë°±ë¶„ìœ¨
    },
    {
      "name": "ì¤‘ê°„ê³ ì‚¬",
      "score": 85,
      "maxScore": 100,
      "submitted": true,
      "percentage": 85.0
    }
  ]
}
```

### 4.4 ì´ì  (grade.total)

```json
{
  "total": {
    "score": 204.5,          // ì´ íšë“ ì ìˆ˜
    "maxScore": 230,         // ì´ ë§Œì 
    "percentage": 88.9       // ì´ ë°±ë¶„ìœ¨
  }
}
```

---

## ğŸ“ ìš©ëŸ‰ ë¶„ì„

### ğŸ“Š ì˜ˆìƒ í¬ê¸° (ë°”ì´íŠ¸)

| ì„¹ì…˜ | ì¼ë°˜ì  í¬ê¸° | ìµœëŒ€ í¬ê¸° | ì„¤ëª… |
|------|-------------|-----------|------|
| **enrollment** | 120 | 150 | ìˆ˜ê°•ì‹ ì²­ ê¸°ë³¸ ì •ë³´ |
| **attendance.summary** | 180 | 200 | ì¶œì„ í†µê³„ |
| **attendance.sessions** | 6,000 | 12,000 | 40ê°œ â†’ 80ê°œ |
| **attendance.pendingRequests** | 600 | 9,600 | 5ê°œ â†’ 80ê°œ |
| **gradeConfig** | 250 | 300 | ì„±ì  ì„¤ì • |
| **grade** | 800 | 1,200 | ì„±ì  ì •ë³´ |
| **JSON ì˜¤ë²„í—¤ë“œ** | 500 | 750 | êµ¬ì¡°, ì‰¼í‘œ ë“± |

### ğŸ“ˆ ì´ ìš©ëŸ‰

```
ì¼ë°˜ì ì¸ ê²½ìš°: ì•½ 8.5 KB
ìµœì•…ì˜ ê²½ìš°: ì•½ 24 KB
LONGTEXT ìµœëŒ€: 4 GB

ì—¬ìœ  ê³µê°„: ì•½ 170,000ë°°
```

---

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### 1ï¸âƒ£ í•™ìƒ ì¶œì„ ìš”ì²­
```
1. í•™ìƒ ì¶œì„ ìš”ì²­
2. pendingRequestsì— ì¶”ê°€
3. tempApproved: true (ì„ì‹œ ìŠ¹ì¸)
4. expiresAt: requestDate + 7ì¼
```

### 2ï¸âƒ£ êµìˆ˜ ìŠ¹ì¸/ê±°ë¶€
```
1. êµìˆ˜ ìŠ¹ì¸ ì²˜ë¦¬
2. pendingRequestsì—ì„œ ì œê±°
3. sessionsì— ì¶”ê°€ (status: ì¶œ/ì§€/ê²°)
4. summary ìë™ ì¬ê³„ì‚°
```

### 3ï¸âƒ£ ìë™ ìŠ¹ì¸ (ìŠ¤ì¼€ì¤„ëŸ¬)
```
1. ë§¤ì¼ ì˜¤ì „ 5ì‹œ ì‹¤í–‰
2. expiresAt ë§Œë£Œ í™•ì¸
3. pendingRequests â†’ sessions ì´ë™
4. status: "ì¶œ" (ìë™ ì¶œì„)
```

### 4ï¸âƒ£ ì„±ì  ì—°ë™
```
1. attendance.summary ì—…ë°ì´íŠ¸
2. grade.attendance ìë™ ê³„ì‚°
3. grade.total ì¬ê³„ì‚°
4. ì´ë²¤íŠ¸ ê¸°ë°˜ ì—…ë°ì´íŠ¸
```

---

## âš ï¸ ì œì•½ì‚¬í•­ ë° ê·œì¹™

### ğŸ“ í¬ê¸° ì œí•œ
- `sessions`: ìµœëŒ€ 80ê°œ (ê°•ì˜ ì´ íšŒì°¨)
- `pendingRequests`: ìµœëŒ€ 80ê°œ (ê°•ì˜ ì´ íšŒì°¨)
- í•œ í•™ìƒë‹¹ ê° íšŒì°¨ë³„ 1ë²ˆì”©ë§Œ ìš”ì²­ ê°€ëŠ¥

### ğŸ”„ ì—…ë°ì´íŠ¸ ê·œì¹™
- **ì›ìì„±**: JSON ì „ì²´ë¥¼ êµì²´ (ë¶€ë¶„ ì—…ë°ì´íŠ¸ ë¶ˆê°€)
- **íŠ¸ëœì­ì…˜**: ë™ì‹œ ìˆ˜ì • ë°©ì§€
- **ì´ë²¤íŠ¸**: ì¶œì„ ë³€ê²½ ì‹œ ì„±ì  ìë™ ì¬ê³„ì‚°

### ğŸ“… ì‹œê°„ ê·œì¹™
- `expiresAt`: ìš”ì²­ì¼ë¡œë¶€í„° ì •í™•íˆ 7ì¼ í›„
- `ìŠ¤ì¼€ì¤„ëŸ¬`: ë§¤ì¼ ì˜¤ì „ 5ì‹œ (Asia/Seoul)
- `ë§Œë£Œ ì²˜ë¦¬`: ì„œë²„ ì‹œê°„ ê¸°ì¤€

---

## ğŸ› ï¸ êµ¬í˜„ ê³ ë ¤ì‚¬í•­

### ì„±ëŠ¥ ìµœì í™”
```sql
-- JSON ì¸ë±ìŠ¤ ìƒì„± (ì„ íƒì‚¬í•­)
ALTER TABLE ENROLLMENT_EXTENDED_TBL 
ADD INDEX idx_attendance_rate (
  (CAST(JSON_EXTRACT(ENROLLMENT_DATA, '$.attendance.summary.attendanceRate') AS DECIMAL(5,2)))
);
```

### ë²„ì „ ê´€ë¦¬
```json
{
  "version": "2.0",  // ìŠ¤í‚¤ë§ˆ ë²„ì „ ê´€ë¦¬
  // ... ë‚˜ë¨¸ì§€ ë°ì´í„°
}
```

### ìºì‹± ì „ëµ
- Redis ìºì‹± ê³ ë ¤ (ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°)
- summary ì •ë³´ ë³„ë„ ìºì‹±
- ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ vs ë°°ì¹˜ ì—…ë°ì´íŠ¸

---

## ğŸ“– ê´€ë ¨ ë¬¸ì„œ

- [ì¶œì„ ìš”ì²­/ìŠ¹ì¸ í”Œë¡œìš°](../../ì¶œê²°ê´€ë¦¬/ì¶œì„ìš”ì²­ìŠ¹ì¸_í”Œë¡œìš°.md)
- [ì„±ì  ê´€ë¦¬ ì‹œìŠ¤í…œ](../../ì„±ì ê´€ë¦¬/ì„±ì ê´€ë¦¬_ì‹œìŠ¤í…œ_ë¬¸ì„œ.md)
- [ë¸Œë¼ìš°ì € ì½˜ì†” í…ŒìŠ¤íŠ¸](../../ë¸Œë¼ìš°ì €ì½˜ì†”í…ŒìŠ¤íŠ¸/06-attendance/README.md)
- [ì‘ì—… ìˆœì„œ ê°€ì´ë“œ](../../ì¶œê²°ê´€ë¦¬/ì‘ì—…%20ìˆ˜ìˆœ/01_ì‘ì—…_ìˆœì„œ_ì „ì²´.md)

---

## ğŸ“ ê°œë°œíŒ€ ì—°ë½ì²˜

JSON êµ¬ì¡° ë³€ê²½ì´ë‚˜ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ë©´ ë°±ì—”ë“œ ê°œë°œíŒ€ì— ì—°ë½í•˜ì„¸ìš”.