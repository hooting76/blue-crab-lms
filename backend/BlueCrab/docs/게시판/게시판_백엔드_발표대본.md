# 게시판 백엔드 발표 대본 (요약본)
## Blue-Crab LMS 게시판 시스템 백엔드 구현

**발표 시간**: 5분  
**발표자**: [이름]

---

## ⏱️ 발표 구성

| 순서 | 내용 | 시간 | 누적 |
|------|------|------|------|
| 0 | 인트로 | 30초 | 0:30 |
| 1 | 코드 1: 목록 조회 | 1분 20초 | 1:50 |
| 2 | 코드 2: 상세 조회 | 1분 | 2:50 |
| 3 | 코드 3: JWT 인증 | 1분 | 3:50 |
| 4 | 코드 4: 파일 업로드 | 50초 | 4:40 |
| 5 | 마무리 | 20초 | 5:00 |

---

## 🎬 인트로 (30초)

**대본 요점:**
- 자기소개 + 담당 파트 (게시판 백엔드)
- 4계층 구조 소개 (Controller → Service → Repository → Entity)
- 오늘 보여줄 것: 조회, 생성, 인증, 첨부파일

**멘트:**
"안녕하세요. Blue-Crab LMS 게시판 백엔드를 담당한 [이름]입니다. 
4계층 구조로 설계했고, 오늘은 핵심 코드 4개를 보여드리겠습니다."

**[다이어그램: board-architecture.drawio]**

---

## 💻 코드 1: 목록 조회 API (1분 20초)

### 핵심 포인트
- ✅ 하나의 API로 3가지 조회 방식 처리
- ✅ 성능 최적화: 목록 조회 시 본문 제외
- ✅ 페이징 처리 (Page 객체)

### 대본 요점

**1. 도입 (10초)**
"첫 번째는 게시글 목록 조회 API입니다. 하나의 엔드포인트로 세 가지 조회를 처리합니다."

**2. 파라미터 설명 (15초)**
[코드 상단 가리키며]
"boardCode(게시판 코드), lecSerial(강의번호), page, size를 받습니다."

**3. if 분기 로직 (40초)**
[if문 가리키며]
- "첫 번째: boardCode=3 + lecSerial → 특정 강의 공지만"
- "두 번째: boardCode만 → 해당 게시판 전체"
- "세 번째: 둘 다 없음 → 전체 조회"

**4. 성능 최적화 (15초)**
"ForList 메서드들은 본문을 제외합니다. 목록에선 제목만 필요하니까요. 
DB 부하가 줄고 응답이 빨라집니다."

---

## 💻 코드 2: 상세 조회 + 첨부파일 (1분)

### 핵심 포인트
- ✅ 본문 포함 완전한 데이터
- ✅ 첨부파일 자동 조회 및 통합
- ✅ 조회수 자동 증가

### 대본 요점

**1. 도입 (10초)**
"다음은 상세 조회 API입니다. 목록과 달리 본문을 포함하고 조회수도 증가시킵니다."

**2. Optional 처리 (15초)**
[코드 시작 부분]
"boardIdx로 게시글을 조회하고, Optional로 안전하게 확인합니다."

**3. 첨부파일 통합 (25초)** ⭐
[첨부파일 조회 부분 강조]
"핵심은 여기입니다. 게시글 조회 후 자동으로 첨부파일도 조회합니다.
getActiveAttachmentsByBoardId()로 첨부파일을 가져와서 
setAttachmentDetails()로 게시글 객체에 통합합니다.
클라이언트는 한 번의 요청으로 게시글과 첨부파일을 모두 받습니다."

**4. 에러 처리 (10초)**
"게시글이 없으면 404를 반환합니다."

---

## 💻 코드 3: JWT 인증 (1분)

### 핵심 포인트
- ✅ 3단계 보안 검증
- ✅ 명확한 에러 메시지
- ✅ 사용자 식별 및 권한 확인

### 대본 요점

**1. 도입 (10초)**
"이제 보안 부분입니다. 게시글 작성 시 JWT 인증 로직입니다."

**2. 헤더 확인 (15초)**
[Authorization 부분]
"먼저 Authorization 헤더에서 토큰을 추출합니다. 
없거나 Bearer로 시작 안 하면 401 반환."

**3. 3단계 검증 (25초)** ⭐
[검증 로직 강조]
"3단계로 검증합니다.
1단계: isTokenValid() - 만료나 변조 확인
2단계: isAccessToken() - 액세스 토큰인지 확인, 리프레시 토큰은 차단
3단계: extractUsername() - JWT에서 이메일 추출"

**4. 권한 확인 (10초)**
"추출한 이메일로 Service에서 권한을 확인해서 
관리자나 강사만 게시글을 작성할 수 있게 합니다."

---

## 💻 코드 4: 첨부파일 업로드 (50초)

### 핵심 포인트
- ✅ MultipartFile로 다중 파일 업로드
- ✅ JWT 인증 필수
- ✅ 3단계 워크플로우의 2단계
- ✅ 다층 제한 검증 (용량/개수/타입)

### 대본 요점

**1. 도입 (10초)**
"마지막으로 첨부파일 업로드 기능입니다."

**2. 파라미터 설명 (10초)**
[파라미터 부분]
"PathVariable로 게시글 ID를, RequestParam으로 파일 목록을 받습니다.
List<MultipartFile>이라 여러 파일을 한 번에 업로드할 수 있습니다."

**3. 제한 사항 검증 (15초)** ⭐
[Service 검증 로직 강조]
"보안을 위해 다층 검증을 합니다.
개별 파일은 15MB 제한, 게시글당 최대 5개 파일까지만 허용합니다.
또한 pdf, doc, 이미지 등 13종류의 확장자만 허용하고, 
업로드된 파일은 30일 후 자동 만료됩니다."

**4. 업로드 처리 (10초)**
[Service 호출]
"JWT 검증과 제한 확인 후, uploadService로 실제 저장을 처리하고
성공하면 각 파일의 attachmentIdx를 배열로 반환합니다."

**5. 3단계 워크플로우 (5초)** ⭐
[다이어그램 보여주며]
"이게 3단계 워크플로우의 2단계입니다.
1단계: 게시글 생성 → 2단계: 파일 업로드 → 3단계: 연결"

**[다이어그램: attachment-workflow-detailed.drawio]**

---

## 🎯 마무리 (20초)

### 기술 특징 6가지
1. ✅ RESTful API 설계
2. ✅ JWT 3단계 인증
3. ✅ 4계층 아키텍처
4. ✅ 성능 최적화 (페이징, 선택적 조회)
5. ✅ 체계적인 첨부파일 관리
6. ✅ 다층 보안 검증 (용량/개수/타입 제한)

**멘트:**
"정리하면, RESTful API 설계, JWT 인증, 4계층 구조, 
성능 최적화, 체계적인 첨부파일 관리, 그리고 다층 보안 검증이 핵심입니다.
이상 발표 마치겠습니다. 감사합니다."

---

## 📊 타이밍 체크리스트

- [ ] 0:00-0:30 인트로
- [ ] 0:30-1:50 코드1 (목록 조회)
- [ ] 1:50-2:50 코드2 (상세 조회)
- [ ] 2:50-3:50 코드3 (JWT 인증)
- [ ] 3:50-4:40 코드4 (파일 업로드)
- [ ] 4:40-5:00 마무리

---

## 💡 발표 핵심 팁

### 제스처
- 코드 특정 부분 가리키며 설명
- 중요한 부분은 목소리 톤 높이기

### 강조 키워드
- "하나의 엔드포인트로", "3단계 검증", "자동으로 연결"
- "성능 최적화", "명확한 에러", "체계적인 관리"

### 자연스러운 전환
- 코드1→2: "다음은 상세 조회입니다..."
- 코드2→3: "이제 보안 부분입니다..."
- 코드3→4: "마지막으로 첨부파일입니다..."

---

## 📝 예상 질문 (간단 답변)

**Q: 왜 목록에서 본문 제외?**
→ "목록엔 제목만 필요해서 성능 최적화했습니다."

**Q: 첨부파일 왜 3단계?**
→ "각 단계를 독립적으로 관리하면 에러 처리가 명확해집니다."

**Q: JWT를 Controller에서 검증하는 이유?**
→ "API별로 다른 인증 로직이 필요해서 명시적으로 처리했습니다."

**Q: 파일 용량 제한 15MB인 이유?**
→ "일반적인 문서/이미지 크기를 고려하고, 서버 부하를 방지하기 위해서입니다."

**Q: 파일 30일 만료 정책?**
→ "저장소 관리와 개인정보 보호를 위한 정책입니다."

---

## 📌 슬라이드별 코드 위치

| 코드 | 파일명 | 라인 |
|------|--------|------|
| 1 | BoardController.java | 62-98 |
| 2 | BoardController.java | 119-142 |
| 3 | BoardCreateController.java | 68-110 |
| 4 | BoardAttachmentUploadController.java | 57-98 |

---

## 🎨 슬라이드 우측 설명문 (복사용)

### 코드 1: 목록 조회 API
```
🚀 핵심 기능: 유연한 게시글 목록 조회 API

✅ 3가지 조회 방식을 하나의 엔드포인트로 처리
   • 전체 게시글 조회
   • 게시판 코드별 조회 (공지사항, 학사정보 등)
   • 강의별 공지 조회 (특정 강의 학생만 열람)

🚀 성능 최적화
   • 목록 조회 시 본문(content) 제외
   • 페이징 처리로 대량 데이터 효율적 관리
   • Page<Map<String, Object>> 반환 타입 활용

🔍 동적 라우팅
   • if 조건문으로 요청 파라미터 분석
   • 적절한 Service 메서드 자동 선택
```

### 코드 2: 상세 조회 API
```
🚀 핵심 기능: 완전한 게시글 조회

🔹 3단계 자동 처리 프로세스
   1. 게시글 조회 (본문 포함)
   2. 첨부파일 자동 검색
   3. 데이터 통합 및 반환

🔹 조회수 관리
   • Service 레이어에서 자동 +1 증가
   • 조회 시마다 업데이트

🔹 Optional 안전성
   • Null 체크 자동화
   • 존재하지 않으면 404 응답

🔹 첨부파일 통합
   • boardIdx로 자동 조회
   • setAttachmentDetails() 호출
   • 클라이언트는 추가 요청 불필요

💡 목록 조회와의 차이점
   ✅ 본문 포함 / 조회수 증가 / 첨부파일 통합
   ❌ 목록은 제목만 / 조회수 X / 첨부파일 X
```

### 코드 3: JWT 인증
```
🔐 핵심 기능: JWT 기반 인증 시스템

✅ 3단계 보안 검증

1️⃣ Authorization 헤더 확인
   • "Bearer {token}" 형식 체크
   • 없으면 → 401 "로그인 필요"

2️⃣ JWT 토큰 유효성 검증
   • isTokenValid() - 만료/변조 확인
   • 실패 → 401 "토큰 만료"

3️⃣ 액세스 토큰 타입 확인
   • isAccessToken() - 타입 검증
   • Refresh 토큰 차단 ❌
   • 실패 → 401 "액세스 토큰 필요"

👤 사용자 식별
   • extractUsername(token)
   • JWT에서 이메일 추출
   • Service에 전달하여 권한 확인

🛡️ 명확한 에러 메시지
   • 각 단계별 구체적인 실패 이유 제공
   • success: false + errorCode 반환
```

### 코드 4: 첨부파일 업로드
```
🚀 핵심 기능: 첨부파일 업로드 API

📁 다중 파일 지원
   • List<MultipartFile> 처리
   • 한 번에 여러 파일 업로드 가능
   • FormData 형식으로 전송

🔐 보안 처리
   • JWT 토큰 검증 필수
   • 인증된 사용자만 업로드 가능

⚖️ 다층 제한 검증
   • 개별 파일: 최대 15MB
   • 게시글당: 최대 5개 파일
   • 허용 확장자: 13종 (pdf, doc, docx, xls, xlsx, ppt, pptx, txt, jpg, jpeg, png, gif, zip)
   • 파일 만료: 업로드 후 30일

📊 응답 데이터
   • 업로드 성공 여부 (success)
   • 파일 개수 (fileCount)
   • 각 파일의 attachmentIdx 배열

🔄 3단계 워크플로우
   1️⃣ 게시글 생성 → boardIdx
   2️⃣ 파일 업로드 → attachmentIdx[]
   3️⃣ /link-attachments로 연결

💡 설계 특징
   • Spring Boot 레벨 + Service 레벨 이중 검증
   • application.properties로 유연한 설정 관리
   • 실패 시 명확한 에러 메시지 제공
```

---

**문서 작성일**: 2025년 10월 27일  
**버전**: 2.0 (요약본)

