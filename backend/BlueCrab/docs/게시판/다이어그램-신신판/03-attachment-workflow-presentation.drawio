<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36" version="28.2.8">
  <diagram name="Attachment Complete" id="attachment-complete">
    <mxGraphModel dx="1426" dy="777" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1080" background="light-dark(#FFFFFF,#FFFFFF)" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="03. 첨부파일 시스템 (API + 워크플로우)" style="text;html=1;strokeColor=#432D57;fillColor=#76608a;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;fontStyle=1;fontColor=#ffffff;strokeWidth=3;" parent="1" vertex="1">
          <mxGeometry x="260" y="50" width="1400" height="60" as="geometry" />
        </mxCell>
        <mxCell id="m0r0hmJ436ld6sedApBM-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="workflow-section" target="api-upload-title" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="workflow-section" value="🔄 3단계 워크플로우" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=none;fontSize=24;fontStyle=1;fontColor=#ffffff;align=left;verticalAlign=top;spacingLeft=20;spacingTop=10;points=[[0,0,0,0,0],[0,0.25,0,0,0],[0,0.5,0,0,0],[0,0.75,0,0,0],[0,1,0,0,0],[0.25,0,0,0,0],[0.25,1,0,0,0],[0.5,0,0,0,0],[0.5,1,0,0,0],[0.75,0,0,0,0],[0.75,1,0,0,0],[1,0,0,0,0],[1,0.25,0,0,0],[1,0.5,0,0,0],[1,0.75,0,0,0],[1,1,0,0,0]];" parent="1" vertex="1">
          <mxGeometry x="60" y="120" width="900" height="60" as="geometry" />
        </mxCell>
        <mxCell id="step1-box" value="1️⃣ 게시글 생성" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2e7d32;strokeColor=#1b5e20;fontSize=20;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="90" y="180" width="840" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step1-api" value="POST /api/boards/create" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=16;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="240" width="280" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step1-data" value="boardTitle, boardContent&#xa;boardCode: 0-3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;strokeColor=#6D1F00;fontSize=14;align=left;spacingLeft=10;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="410" y="240" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step1-result" value="→ boardIdx: 123 반환" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#647687;strokeColor=#314354;fontSize=16;fontColor=#ffffff;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="670" y="240" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=3;strokeColor=#00cc00;dashed=1;fontColor=light-dark(#FFFFFF,#FFFFFF);" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="509.57" y="285" as="sourcePoint" />
            <mxPoint x="509.57" y="315" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="step2-box" value="2️⃣ 파일 업로드" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b0000;strokeColor=#5d0000;fontSize=20;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="90" y="320" width="840" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step2-api" value="POST /api/board-attachments&#xa;/upload/{boardIdx}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=15;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="380" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step2-data" value="FormData: files (최대 5개)&#xa;⚠️ JSON 불가!" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;strokeColor=#6D1F00;fontSize=14;align=left;spacingLeft=10;fontColor=#ffffff;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="390" y="380" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step2-storage" value="📁 MinIO 저장&#xa;🗄️ BoardAttachmentTbl 저장" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3c800;strokeColor=#B09500;fontSize=13;align=left;spacingLeft=10;fontColor=#000000;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="440" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step2-result" value="→ attachmentIdx[]&#xa;  [45, 46] 반환" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#647687;strokeColor=#314354;fontSize=15;fontColor=#ffffff;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="650" y="380" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=3;strokeColor=#00cc00;dashed=1;fontColor=light-dark(#FFFFFF,#FFFFFF);" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="509.57" y="500" as="sourcePoint" />
            <mxPoint x="509.57" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="step3-box" value="3️⃣ 첨부파일 연결" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4b0082;strokeColor=#2d004e;fontSize=20;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="90" y="534" width="840" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step3-api" value="POST /api/boards&#xa;/link-attachments/{boardIdx}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=15;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="595" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step3-data" value="attachmentIdxList: [45, 46]" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;strokeColor=#6D1F00;fontSize=15;align=left;spacingLeft=10;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="390" y="595" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step3-db" value="🗄️ BoardAttachmentTbl&#xa;boardIdx 업데이트" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3c800;strokeColor=#B09500;fontSize=14;align=left;spacingLeft=10;fontColor=#000000;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="660" width="520" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step3-result" value="→ 연결 완료!" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#647687;strokeColor=#314354;fontSize=16;fontColor=#ffffff;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="650" y="595" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="api-section" value="📡 API 엔드포인트" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=none;fontSize=24;fontStyle=1;fontColor=#ffffff;align=left;verticalAlign=top;spacingLeft=20;spacingTop=10;" parent="1" vertex="1">
          <mxGeometry x="1000" y="120" width="860" height="60" as="geometry" />
        </mxCell>
        <mxCell id="api-upload-title" value="📤 파일 업로드" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b0000;strokeColor=#5d0000;fontSize=18;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1010" y="180" width="400" height="45" as="geometry" />
        </mxCell>
        <mxCell id="api-upload" value="POST /api/board-attachments/upload/{boardIdx}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=14;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1010" y="240" width="400" height="35" as="geometry" />
        </mxCell>
        <mxCell id="api-upload-detail" value="🔒 JWT 필수 | FormData 전송 → attachmentIdx[] 반환" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;strokeColor=#6D1F00;fontSize=14;align=left;spacingLeft=10;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1010" y="285" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="api-link-title" value="🔗 첨부파일 연결" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4b0082;strokeColor=#2d004e;fontSize=18;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1010" y="345" width="400" height="45" as="geometry" />
        </mxCell>
        <mxCell id="api-link" value="POST /api/boards/link-attachments/{boardIdx}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=14;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1010" y="405" width="400" height="35" as="geometry" />
        </mxCell>
        <mxCell id="api-link-detail" value="🔒 JWT 필수 | JSON: attachmentIdxList → 연결 완료" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;strokeColor=#6D1F00;fontSize=14;align=left;spacingLeft=10;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1010" y="450" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="api-download-title" value="📥 파일 다운로드" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1976d2;strokeColor=#0d47a1;fontSize=18;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1430" y="180" width="390" height="45" as="geometry" />
        </mxCell>
        <mxCell id="api-download" value="POST /api/board-attachments/download" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=14;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1430" y="240" width="390" height="35" as="geometry" />
        </mxCell>
        <mxCell id="api-download-detail" value="입력: attachmentIdx&amp;nbsp;→ Blob 파일 (브라우저 자동 다운로드)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;strokeColor=#6D1F00;fontSize=14;align=left;spacingLeft=10;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1430" y="285" width="390" height="40" as="geometry" />
        </mxCell>
        <mxCell id="api-info-title" value="ℹ️ 파일 정보 조회" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2e7d32;strokeColor=#1b5e20;fontSize=18;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1430" y="345" width="390" height="45" as="geometry" />
        </mxCell>
        <mxCell id="api-info" value="POST /api/board-attachments/info" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=14;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1430" y="405" width="390" height="35" as="geometry" />
        </mxCell>
        <mxCell id="api-info-detail" value="입력: boardIdx&amp;nbsp;→ attachmentIdx, fileName, fileSize 등" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#a0522d;strokeColor=#6D1F00;fontSize=14;align=left;spacingLeft=10;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1430" y="450" width="390" height="40" as="geometry" />
        </mxCell>
        <mxCell id="api-delete-title" value="🗑️ 파일 삭제" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c62828;strokeColor=#8b0000;fontSize=18;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="1010" y="510" width="810" height="45" as="geometry" />
        </mxCell>
        <mxCell id="api-delete-single" value="단일: POST /api/board-attachments/delete/{attachmentIdx}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=14;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1010" y="570" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="api-delete-multiple" value="다중: POST /api/board-attachments/delete-multiple" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d2691e;strokeColor=#8B4513;fontSize=14;fontColor=light-dark(#FFFFFF,#FFFFFF);fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1440" y="570" width="380" height="40" as="geometry" />
        </mxCell>
        <mxCell id="db-section" value="🗄️ 데이터베이스 구조" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=none;fontSize=24;fontStyle=1;fontColor=#ffffff;align=left;verticalAlign=top;spacingLeft=20;spacingTop=10;" parent="1" vertex="1">
          <mxGeometry x="1000" y="650" width="860" height="50" as="geometry" />
        </mxCell>
        <mxCell id="db-board" value="BOARD_TBL&#xa;boardIdx (PK)&#xa;boardTitle, boardContent" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#1976d2;strokeColor=#0d47a1;fontSize=14;fontColor=#ffffff;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1030" y="710" width="230" height="100" as="geometry" />
        </mxCell>
        <mxCell id="db-attachment" value="BOARD_ATTACHMENT_TBL&#xa;attachmentIdx (PK)&#xa;boardIdx (FK)&#xa;originalFileName, filePath" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#2e7d32;strokeColor=#1b5e20;fontSize=13;fontColor=#ffffff;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1310" y="700" width="250" height="120" as="geometry" />
        </mxCell>
        <mxCell id="db-minio" value="MinIO&#xa;객체 스토리지&#xa;실제 파일 저장" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#8b4513;strokeColor=#5d2906;fontSize=14;fontColor=#ffffff;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1610" y="710" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="db-arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=3;strokeColor=light-dark(#0D47A1,#0000FF);startArrow=classic;startFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="db-board" target="db-attachment" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1260" y="759.58" as="sourcePoint" />
            <mxPoint x="1290" y="759.58" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-arrow2" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=3;strokeColor=light-dark(#0D47A1,#0000FF);entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="db-attachment" target="db-minio" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1550" y="760" as="sourcePoint" />
            <mxPoint x="1580" y="760" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="warning-section" value="⚠️ 주요 주의사항" style="rounded=1;whaceWrap;html=1;fillColor=#ffc0cb;strokeColor=#d8576b;fontSize=22;fontStyle=1;fontColor=#000000;align=left;verticalAlign=top;spacingLeft=20;spacingTop=10;arcSize=8;" parent="1" vertex="1">
          <mxGeometry x="90" y="740" width="900" height="190" as="geometry" />
        </mxCell>
        <mxCell id="warning-content" value="• 3단계는 반드시 순서대로 실행 필수&lt;br&gt;• 2단계: FormData 형식만 가능 (JSON ❌)&lt;br&gt;• 각 단계 응답에서 다음 단계 입력값 추출&lt;br&gt;• 파일 제한: 최대 5개, 각 1MB, 총합 20MB&lt;br&gt;• 허용 확장자: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, TXT, JPG, JPEG, PNG, GIF" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;spacingLeft=20;spacingTop=10;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="110" y="800" width="860" height="100" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
