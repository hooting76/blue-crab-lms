<mxfile host="app.diagrams.net" agent="Mozilla/5.0" version="28.2.8">
  <diagram name="ENROLLMENT_DATA JSON" id="enrollment-json-structure">
    <mxGraphModel dx="1920" dy="1080" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1080" background="#FFFFFF" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- 제목 -->
        <mxCell id="title" value="ENROLLMENT_DATA JSON 구조" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;fontStyle=1;fontColor=#1A1A1A;" parent="1" vertex="1">
          <mxGeometry x="640" y="40" width="640" height="60" as="geometry" />
        </mxCell>

        <!-- 설명 박스 -->
        <mxCell id="description" value="GradeCalculationService에서 참조하는 핵심 JSON 필드 맵" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1E88E5;strokeWidth=2;fontSize=18;fontColor=#1565C0;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="600" y="120" width="720" height="70" as="geometry" />
        </mxCell>

        <!-- 루트 JSON -->
        <mxCell id="rootJson" value="{\n  \"studentInfo\": {...},\n  \"attendance\": {...},\n  \"grade\": {...}\n}" style="html=1;whiteSpace=wrap;align=left;verticalAlign=top;rounded=1;strokeColor=#37474F;strokeWidth=3;fillColor=#FFFFFF;fontFamily=Courier New;fontSize=18;fontColor=#263238;" parent="1" vertex="1">
          <mxGeometry x="280" y="260" width="520" height="480" as="geometry" />
        </mxCell>

        <!-- studentInfo -->
        <mxCell id="studentInfo" value="studentInfo" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#4E342E;strokeWidth=3;fillColor=#D7CCC8;fontStyle=1;fontSize=20;fontColor=#3E2723;" parent="1" vertex="1">
          <mxGeometry x="940" y="240" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="studentInfoFields" value="• studentIdx : number\n• userCode : string\n• name : string\n• major : string\n• gradeLevel : number" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#4E342E;strokeWidth=2;fillColor=#F5E6DC;fontSize=18;fontColor=#3E2723;" parent="1" vertex="1">
          <mxGeometry x="940" y="330" width="300" height="200" as="geometry" />
        </mxCell>

        <!-- attendance -->
        <mxCell id="attendance" value="attendance" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1B5E20;strokeWidth=3;fillColor=#C8E6C9;fontStyle=1;fontSize=20;fontColor=#1B5E20;" parent="1" vertex="1">
          <mxGeometry x="940" y="560" width="340" height="80" as="geometry" />
        </mxCell>
        <mxCell id="attendanceBody" value="• totalSessions : number\n• attendedSessions : number\n• sessions : [\n    { sessionNo, date, status, approvedBy }\n  ]\n• lastUpdated : ISO datetime" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1B5E20;strokeWidth=2;fillColor=#E8F5E9;fontSize=18;fontColor=#1B5E20;" parent="1" vertex="1">
          <mxGeometry x="940" y="650" width="340" height="240" as="geometry" />
        </mxCell>

        <!-- grade -->
        <mxCell id="grade" value="grade" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#283593;strokeWidth=3;fillColor=#C5CAE9;fontStyle=1;fontSize=20;fontColor=#1A237E;" parent="1" vertex="1">
          <mxGeometry x="1380" y="240" width="360" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gradeBody" value="• components : {\n    attendanceRatio : number,\n    assignmentRatio : number,\n    examRatio : number\n  }\n• assignments : [\n    { taskIdx, name, maxScore, score, weight }\n  ]\n• exams : [\n    { examType, maxScore, score, weight }\n  ]\n• totalScore : number\n• letterGrade : string\n• updatedAt : ISO datetime" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#283593;strokeWidth=2;fillColor=#E8EAF6;fontSize=18;fontColor=#1A237E;" parent="1" vertex="1">
          <mxGeometry x="1380" y="330" width="360" height="360" as="geometry" />
        </mxCell>

        <!-- analytics -->
        <mxCell id="analytics" value="analytics" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#00695C;strokeWidth=3;fillColor=#B2DFDB;fontStyle=1;fontSize=20;fontColor=#004D40;" parent="1" vertex="1">
          <mxGeometry x="1380" y="720" width="360" height="80" as="geometry" />
        </mxCell>
        <mxCell id="analyticsBody" value="• percentile : number\n• rank : number\n• gradeHistory : [ { totalScore, updatedAt } ]" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#00695C;strokeWidth=2;fillColor=#E0F2F1;fontSize=18;fontColor=#004D40;" parent="1" vertex="1">
          <mxGeometry x="1380" y="810" width="360" height="170" as="geometry" />
        </mxCell>

        <!-- 연결선 -->
        <mxCell id="edgeStudentInfo" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeWidth=2;strokeColor=#4E342E;endArrow=block;endFill=1;" parent="1" source="rootJson" target="studentInfo" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="320" as="exitPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="edgeAttendance" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeWidth=2;strokeColor=#1B5E20;endArrow=block;endFill=1;" parent="1" source="rootJson" target="attendance" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="560" as="exitPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="edgeGrade" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeWidth=2;strokeColor=#283593;endArrow=block;endFill=1;" parent="1" source="rootJson" target="grade" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="400" as="exitPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="edgeAnalytics" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeWidth=2;strokeColor=#00695C;endArrow=block;endFill=1;" parent="1" source="rootJson" target="analytics" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="760" as="exitPoint" />
          </mxGeometry>
        </mxCell>

        <!-- 주석 박스 -->
        <mxCell id="note" value="핵심 포인트\n1. attendance.sessions는 출석 요청 승인 결과가 반영됨\n2. assignments / exams 배열이 GradeUpdateEvent 재계산에 입력됨\n3. analytics는 통계 캐시로, GradeCalculation 후 업데이트" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#9E9E9E;strokeWidth=2;fillColor=#FAFAFA;fontSize=18;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="280" y="770" width="520" height="220" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
