# 06. ìµœì¢… ë“±ê¸‰ ë°°ì • API

> êµìˆ˜ê°€ ìƒëŒ€í‰ê°€ë¡œ A/B/C/D/F ë“±ê¸‰ì„ ë°°ì •í•˜ëŠ” API

---

## ğŸ“Œ ê¸°ë³¸ ì •ë³´

- **ì—”ë“œí¬ì¸íŠ¸**: `POST /api/enrollments/assign-grades`
- **ê¶Œí•œ**: êµìˆ˜
- **ì„¤ëª…**: ì „ì²´ ìˆ˜ê°•ìƒì˜ ì ìˆ˜ ë¶„í¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìƒëŒ€í‰ê°€ ë“±ê¸‰ ë°°ì •

---

## ğŸ“¥ Request

```json
{
  "lecSerial": "ETH201",
  "gradeDistribution": {
    "A": 30,
    "B": 40,
    "C": 20,
    "D": 5,
    "F": 5
  }
}
```

| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| lecSerial | String | âœ… | ê°•ì˜ ì½”ë“œ |
| gradeDistribution | Object | âœ… | ë“±ê¸‰ë³„ ë¹„ìœ¨ (í•©ê³„ 100%) |

---

## ğŸ“¤ Response

```json
{
  "success": true,
  "message": "42ëª…ì˜ ìµœì¢… ë“±ê¸‰ì´ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "gradeResult": {
    "A": 13,
    "B": 17,
    "C": 8,
    "D": 2,
    "F": 2
  }
}
```

---

## ğŸ—„ï¸ DB ë³€í™”

**ëª¨ë“  ìˆ˜ê°•ìƒì˜ ENROLLMENT_DATA ì—…ë°ì´íŠ¸**:

### ìƒìœ„ 30% (A)

```json
{
  "grade": {
    "total": {
      "currentScore": 245.5,
      "percentage": 88.6
    },
    "letterGrade": "A"
  }
}
```

### 30~70% (B)

```json
{
  "grade": {
    "total": {
      "currentScore": 198.0,
      "percentage": 71.5
    },
    "letterGrade": "B"
  }
}
```

### 70~90% (C)

```json
{
  "grade": {
    "total": {
      "currentScore": 120.5,
      "percentage": 43.5
    },
    "letterGrade": "C"
  }
}
```

### í•˜ìœ„ 10% (D/F)

```json
{
  "grade": {
    "total": {
      "currentScore": 55.0,
      "percentage": 19.9
    },
    "letterGrade": "F"
  }
}
```

---

## ğŸ”„ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```plaintext
êµìˆ˜ â†’ API: ë“±ê¸‰ ë°°ì • ìš”ì²­ (A 30%, B 40%, ...)
API â†’ DB: í•´ë‹¹ ê°•ì˜ ì „ì²´ ìˆ˜ê°•ìƒ ì¡°íšŒ
API â†’ ë¡œì§: percentage ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
API â†’ ë¡œì§: ìƒìœ„ 30%ì— A, 30~70%ì— B, ... ë°°ì •
API â†’ DB: ê° ìˆ˜ê°•ìƒì˜ ENROLLMENT_DATA.letterGrade ì—…ë°ì´íŠ¸
DB â†’ API: 42ê±´ ì—…ë°ì´íŠ¸ ì™„ë£Œ
API â†’ êµìˆ˜: ë“±ê¸‰ ë°°ì • ê²°ê³¼ (A 13ëª…, B 17ëª…, ...)
```

---

## ğŸ’¡ ë“±ê¸‰ ë°°ì • ì•Œê³ ë¦¬ì¦˜

### 1ë‹¨ê³„: ì ìˆ˜ ì •ë ¬

```java
List<Enrollment> students = enrollmentRepository.findByLecIdx(lecIdx);
students.sort((a, b) -> {
    double percentageA = a.getEnrollmentData().getGrade().getTotal().getPercentage();
    double percentageB = b.getEnrollmentData().getGrade().getTotal().getPercentage();
    return Double.compare(percentageB, percentageA); // ë‚´ë¦¼ì°¨ìˆœ
});
```

### 2ë‹¨ê³„: ë¹„ìœ¨ ê³„ì‚°

- ì´ 42ëª…
- A (30%): 42 Ã— 0.30 = 12.6 â†’ **13ëª…**
- B (40%): 42 Ã— 0.40 = 16.8 â†’ **17ëª…**
- C (20%): 42 Ã— 0.20 = 8.4 â†’ **8ëª…**
- D (5%): 42 Ã— 0.05 = 2.1 â†’ **2ëª…**
- F (5%): 42 Ã— 0.05 = 2.1 â†’ **2ëª…**

### 3ë‹¨ê³„: ë“±ê¸‰ í• ë‹¹

| ìˆœìœ„ | ë“±ê¸‰ | ì¸ì› |
|------|------|------|
| 1~13 | A | 13ëª… |
| 14~30 | B | 17ëª… |
| 31~38 | C | 8ëª… |
| 39~40 | D | 2ëª… |
| 41~42 | F | 2ëª… |

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ë™ì ì ì²˜ë¦¬

- **ë™ì¼ percentage**: ë¨¼ì € ìˆ˜ê°•ì‹ ì²­í•œ í•™ìƒ ìš°ì„ 
- **ê¶Œì¥**: ì†Œìˆ˜ì  3ìë¦¬ê¹Œì§€ ê³„ì‚°í•˜ì—¬ ë™ì ì ìµœì†Œí™”

### ë¹„ìœ¨ í•©ê³„ ê²€ì¦

```java
int sum = distribution.values().stream().mapToInt(Integer::intValue).sum();
if (sum != 100) {
    throw new IllegalArgumentException("ë“±ê¸‰ ë¹„ìœ¨ì˜ í•©ê³„ëŠ” 100%ì—¬ì•¼ í•©ë‹ˆë‹¤.");
}
```

---

## ğŸ“Š ìµœì¢… ì„±ì í‘œ ì˜ˆì‹œ

| í•™ìƒ | ì¶œì„ | ê³¼ì œ | í•©ê³„ | % | ë“±ê¸‰ |
|------|------|------|------|-----|------|
| ì´ì˜í¬ | 105.0 | 140.5 | 245.5 | 88.6% | **A** |
| ë°•ë¯¼ìˆ˜ | 100.5 | 97.5 | 198.0 | 71.5% | **B** |
| ê¹€ì² ìˆ˜ | 75.5 | 45.0 | 120.5 | 43.5% | **C** |
| ìµœí•˜ë‚˜ | 30.0 | 25.0 | 55.0 | 19.9% | **F** |

---

## ğŸ“‹ ì™„ë£Œ

ë“±ê¸‰ ë°°ì • ì™„ë£Œ í›„:

- í•™ìƒì€ **ì„±ì  ì¡°íšŒ API**ì—ì„œ ìµœì¢… ë“±ê¸‰ í™•ì¸ ê°€ëŠ¥
- êµìˆ˜ëŠ” **ì„±ì  í™•ì¸ì„œ ë°œê¸‰ API**ë¡œ ì„±ì  ì¦ëª…ì„œ ìƒì„± ê°€ëŠ¥

â†’ [05. ì„±ì  ì¡°íšŒ API](./05_ì„±ì ì¡°íšŒ_API.md) (letterGrade í‘œì‹œë¨)
