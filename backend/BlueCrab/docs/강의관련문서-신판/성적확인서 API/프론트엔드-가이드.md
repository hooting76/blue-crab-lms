# 프론트엔드 가이드

성적확인서 API를 프론트엔드에서 사용하기 위한 가이드

---

## 🔐 인증 처리

### JWT 토큰 전송

```javascript
const response = await fetch('https://bluecrab.chickenkiller.com/BlueCrab-1.0.0/api/transcript/view', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${window.authToken}`  // JWT 토큰
    },
    body: JSON.stringify({
        studentIdx: currentUser.id
    })
});
```

### 에러 처리

```javascript
const result = await response.json();

if (result.status === 'error') {
    switch (response.status) {
        case 401:
            // 인증 실패 - 로그인 페이지로 리다이렉트
            console.log('로그인이 필요합니다');
            window.location.href = '/login';
            break;
            
        case 403:
            // 권한 없음 - 본인 성적만 조회 가능
            alert('본인의 성적만 조회할 수 있습니다');
            break;
            
        case 404:
            // 학생 없음
            alert('학생 정보를 찾을 수 없습니다');
            break;
            
        case 500:
            // 서버 오류
            alert('서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요');
            break;
    }
}
```

---

## 📊 데이터 바인딩

### 응답 구조

```javascript
const transcript = result.data;

// 학생 정보
const student = transcript.student;
console.log(student.studentCode);    // "202500106114"
console.log(student.name);           // "박대현"
console.log(student.currentGrade);   // 1

// 전체 과목 (배열)
const courses = transcript.courses;
courses.forEach(course => {
    console.log(course.lecTitle);     // "자료구조"
    console.log(course.letterGrade);  // "A"
    console.log(course.gpa);          // 4.0
    console.log(course.status);       // "COMPLETED"
});

// 학기별 요약 (객체)
const semesterSummaries = transcript.semesterSummaries;
Object.entries(semesterSummaries).forEach(([key, summary]) => {
    console.log(key);                 // "2025-1"
    console.log(summary.semesterGpa); // 4.0
    console.log(summary.courseCount); // 3
});

// 전체 요약
const overall = transcript.overallSummary;
console.log(overall.cumulativeGpa);   // 4.0
console.log(overall.totalCourses);    // 3
console.log(overall.completionRate);  // 37.5
```

---

## 🎨 상태별 UI 표시

### 상태 코드 → 표시 변환

```javascript
function getStatusDisplay(status) {
    const statusConfig = {
        'COMPLETED': {
            text: '수료',
            icon: '✅',
            color: '#22c55e',  // 초록색
            bgColor: '#dcfce7'
        },
        'FAILED': {
            text: '낙제',
            icon: '❌',
            color: '#ef4444',  // 빨간색
            bgColor: '#fee2e2'
        },
        'IN_PROGRESS': {
            text: '진행중',
            icon: '⏳',
            color: '#3b82f6',  // 파란색
            bgColor: '#dbeafe'
        },
        'NOT_GRADED': {
            text: '미확정',
            icon: '⏸️',
            color: '#6b7280',  // 회색
            bgColor: '#f3f4f6'
        },
        'DROPPED': {
            text: '중도포기',
            icon: '🚫',
            color: '#f59e0b',  // 주황색
            bgColor: '#fef3c7'
        }
    };
    
    return statusConfig[status] || statusConfig['NOT_GRADED'];
}

// 사용 예시
const statusInfo = getStatusDisplay(course.status);
console.log(`${statusInfo.icon} ${statusInfo.text}`);  // "✅ 수료"
```

### React 컴포넌트 예시

```jsx
function StatusBadge({ status }) {
    const config = getStatusDisplay(status);
    
    return (
        <span style={{
            color: config.color,
            backgroundColor: config.bgColor,
            padding: '4px 12px',
            borderRadius: '12px',
            fontSize: '14px',
            fontWeight: '500'
        }}>
            {config.icon} {config.text}
        </span>
    );
}
```

---

## 📐 GPA 포맷팅

### 소수점 표시

```javascript
function formatGpa(gpa) {
    // 소수점 둘째 자리까지 표시
    return gpa.toFixed(2);
}

// 사용 예시
console.log(formatGpa(4.0));     // "4.00"
console.log(formatGpa(3.5));     // "3.50"
console.log(formatGpa(2.67));    // "2.67"
```

### GPA 바 차트

```javascript
function GpaBar({ gpa, maxGpa = 4.0 }) {
    const percentage = (gpa / maxGpa) * 100;
    
    // GPA에 따른 색상
    const getColor = (gpa) => {
        if (gpa >= 3.5) return '#22c55e';      // 초록색 (A)
        if (gpa >= 3.0) return '#3b82f6';      // 파란색 (B)
        if (gpa >= 2.0) return '#f59e0b';      // 주황색 (C)
        if (gpa >= 1.0) return '#ef4444';      // 빨간색 (D)
        return '#6b7280';                      // 회색 (F)
    };
    
    return (
        <div style={{ width: '100%', backgroundColor: '#e5e7eb', borderRadius: '4px', height: '8px' }}>
            <div style={{
                width: `${percentage}%`,
                backgroundColor: getColor(gpa),
                height: '100%',
                borderRadius: '4px',
                transition: 'width 0.3s ease'
            }} />
        </div>
    );
}
```

---

## 📅 학기 정렬

### 학기별 요약 정렬

```javascript
// semesterSummaries는 객체이므로 정렬 필요
const sortedSemesters = Object.entries(transcript.semesterSummaries)
    .sort(([keyA], [keyB]) => keyA.localeCompare(keyB));

sortedSemesters.forEach(([key, summary]) => {
    console.log(`${summary.year}학년도 ${summary.semester}학기`);
    console.log(`학기 GPA: ${summary.semesterGpa.toFixed(2)}`);
});

// 결과:
// 2024학년도 1학기
// 학기 GPA: 3.50
// 2024학년도 2학기
// 학기 GPA: 3.75
// 2025학년도 1학기
// 학기 GPA: 4.00
```

---

## 🗓️ 날짜 포맷팅

### ISO 8601 → 한국어

```javascript
function formatDateTime(isoString) {
    if (!isoString) return 'N/A';
    
    const date = new Date(isoString);
    
    return date.toLocaleString('ko-KR', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
    });
}

// 사용 예시
console.log(formatDateTime('2025-10-29T14:35:22'));
// "2025. 10. 29. 오후 2:35:22"
```

---

## 🎯 Null 처리

### Null 안전 표시

```javascript
function formatRank(course) {
    // 성적 확정 시에만 rank, totalStudents 존재
    if (course.rank && course.totalStudents) {
        return `${course.rank} / ${course.totalStudents}`;
    }
    return '-';  // 또는 'N/A'
}

// letterGrade null 처리
function formatLetterGrade(letterGrade) {
    if (!letterGrade || letterGrade === 'N/A') {
        return '-';
    }
    return letterGrade;
}

// 사용 예시
console.log(formatRank({ rank: 3, totalStudents: 25 }));  // "3 / 25"
console.log(formatRank({ rank: null, totalStudents: null }));  // "-"
```

---

## 📱 UI 구성 예시

### HTML/CSS 레이아웃

```html
<div class="transcript-container">
    <!-- 학생 정보 -->
    <div class="student-info">
        <h2>성 적 확 인 서</h2>
        <table>
            <tr>
                <td>학번</td>
                <td>{{ student.studentCode }}</td>
            </tr>
            <tr>
                <td>이름</td>
                <td>{{ student.name }}</td>
            </tr>
            <tr>
                <td>입학년도</td>
                <td>{{ student.admissionYear }}</td>
            </tr>
            <tr>
                <td>현재학년</td>
                <td>{{ student.currentGrade }}학년</td>
            </tr>
        </table>
    </div>
    
    <!-- 전체 요약 -->
    <div class="overall-summary">
        <h3>전체 요약</h3>
        <div class="summary-grid">
            <div class="summary-item">
                <span class="label">총 수강 과목</span>
                <span class="value">{{ overall.totalCourses }}개</span>
            </div>
            <div class="summary-item">
                <span class="label">취득/신청 학점</span>
                <span class="value">{{ overall.totalEarnedCredits }} / {{ overall.totalAttemptedCredits }}</span>
            </div>
            <div class="summary-item">
                <span class="label">누적 평점</span>
                <span class="value">{{ overall.cumulativeGpa.toFixed(2) }} / 4.0</span>
            </div>
            <div class="summary-item">
                <span class="label">학점 취득률</span>
                <span class="value">{{ overall.completionRate.toFixed(2) }}%</span>
            </div>
        </div>
    </div>
    
    <!-- 수강 내역 -->
    <div class="course-list">
        <h3>수강 내역</h3>
        <table class="course-table">
            <thead>
                <tr>
                    <th>학기</th>
                    <th>과목명</th>
                    <th>교수</th>
                    <th>학점</th>
                    <th>성적</th>
                    <th>GPA</th>
                    <th>백분율</th>
                    <th>등수</th>
                    <th>상태</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="course in courses" :key="course.lecIdx">
                    <td>{{ course.year }}-{{ course.semester }}</td>
                    <td>{{ course.lecTitle }}</td>
                    <td>{{ course.professorName }}</td>
                    <td>{{ course.credits }}</td>
                    <td>{{ course.letterGrade }}</td>
                    <td>{{ course.gpa.toFixed(2) }}</td>
                    <td>{{ course.percentage.toFixed(2) }}%</td>
                    <td>{{ formatRank(course) }}</td>
                    <td><StatusBadge :status="course.status" /></td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <!-- 발급 정보 -->
    <div class="issue-info">
        <p>발급일시: {{ formatDateTime(issuedAt) }}</p>
        <p>발급번호: {{ certificateNumber }}</p>
    </div>
</div>
```

### CSS 스타일

```css
.transcript-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 24px;
    background: #fff;
}

.student-info {
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 24px;
}

.student-info h2 {
    text-align: center;
    margin-bottom: 24px;
    font-size: 24px;
    font-weight: bold;
}

.overall-summary {
    background: #f9fafb;
    padding: 24px;
    border-radius: 8px;
    margin-bottom: 24px;
}

.summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
}

.summary-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.summary-item .label {
    font-size: 14px;
    color: #6b7280;
}

.summary-item .value {
    font-size: 20px;
    font-weight: bold;
    color: #111827;
}

.course-table {
    width: 100%;
    border-collapse: collapse;
}

.course-table th,
.course-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #e5e7eb;
}

.course-table th {
    background: #f9fafb;
    font-weight: 600;
    color: #374151;
}

.issue-info {
    margin-top: 24px;
    padding: 16px;
    background: #f9fafb;
    border-radius: 8px;
    text-align: center;
    color: #6b7280;
}
```

---

## 📊 차트 라이브러리 활용

### Chart.js 학점 분포

```javascript
function renderGradeDistribution(overall) {
    const ctx = document.getElementById('gradeChart').getContext('2d');
    
    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['A', 'B', 'C', 'D', 'F'],
            datasets: [{
                data: [
                    overall.totalGradeACount,
                    overall.totalGradeBCount,
                    overall.totalGradeCCount,
                    overall.totalGradeDCount,
                    overall.totalGradeFCount
                ],
                backgroundColor: [
                    '#22c55e',  // A - 초록
                    '#3b82f6',  // B - 파랑
                    '#f59e0b',  // C - 주황
                    '#ef4444',  // D - 빨강
                    '#6b7280'   // F - 회색
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: '학점 분포'
                }
            }
        }
    });
}
```

---

## ⚠️ 주의사항

### 1. F 등급 GPA 제외

F 등급은 GPA 0.0으로 표시되지만, 실제 누적 GPA 계산에서는 제외됩니다.

```javascript
// 잘못된 예시 (F 포함)
const wrongGpa = courses.reduce((sum, c) => sum + c.gpa * c.credits, 0) 
    / courses.reduce((sum, c) => sum + c.credits, 0);

// 올바른 예시 (F 제외)
const completedCourses = courses.filter(c => c.status === 'COMPLETED');
const correctGpa = completedCourses.reduce((sum, c) => sum + c.gpa * c.credits, 0)
    / completedCourses.reduce((sum, c) => sum + c.credits, 0);
```

### 2. 진행중 과목 표시

```javascript
if (course.status === 'IN_PROGRESS' || course.status === 'NOT_GRADED') {
    // letterGrade가 "진행중", "미확정" 등 임시 값
    // rank, totalStudents는 null
    // GPA 계산에 포함 안 됨
}
```

### 3. 모바일 반응형

```css
@media (max-width: 768px) {
    .summary-grid {
        grid-template-columns: 1fr;
    }
    
    .course-table {
        font-size: 12px;
    }
    
    .course-table th,
    .course-table td {
        padding: 8px 4px;
    }
}
```
