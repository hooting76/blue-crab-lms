# ì¶œì„ API ì‘ë‹µ êµ¬ì¡° ë³€ê²½ì‚¬í•­

**ë‚ ì§œ**: 2025-10-28  
**ë³€ê²½ ì´ìœ **: í”„ë¡ íŠ¸ì—”ë“œ í˜¸í™˜ì„± ê°œì„  (ì¶œì„ íšŸìˆ˜ í‘œì‹œ ì˜¤ë¥˜ ìˆ˜ì •)

---

## ğŸ“‹ ë³€ê²½ ìš”ì•½

ì¶œì„ ì¡°íšŒ API ì‘ë‹µì— **í”„ë¡ íŠ¸ì—”ë“œ í˜¸í™˜ í•„ë“œ 2ê°œ ì¶”ê°€**:
- `attendanceRate`: ì¶œì„ íšŸìˆ˜ë¥¼ "n/80" í˜•ì‹ì˜ ë¬¸ìì—´ë¡œ ì œê³µ
- `attendanceStr`: ì¶œì„ ìƒíƒœë¥¼ ë‚˜ì—´í•œ ë¬¸ìì—´ (ì˜ˆ: "ì¶œì§€ê²°ì¶œ...")

---

## ğŸ”§ ì˜í–¥ë°›ëŠ” API

### 1. í•™ìƒ ì¶œì„ ì¡°íšŒ
**Endpoint**: `POST /api/attendance/student/view`

**Request**:
```json
{
  "lecSerial": "ETH201"
}
```

**Response** (ë³€ê²½ ì „):
```json
{
  "success": true,
  "message": "ì¶œì„ ì¡°íšŒ ì„±ê³µ",
  "data": {
    "summary": {
      "attended": 1,
      "late": 0,
      "absent": 0,
      "totalSessions": 80,
      "attendanceRate": 1.25,
      "updatedAt": "2025-10-28 10:30:00"
    },
    "sessions": [
      {
        "sessionNumber": 1,
        "status": "ì¶œ",
        "requestDate": "2025-10-20 14:00:00",
        "approvedDate": "2025-10-20 15:30:00",
        "approvedBy": 1001,
        "tempApproved": false
      }
    ],
    "pendingRequests": []
  }
}
```

**Response** (ë³€ê²½ í›„) âœ¨:
```json
{
  "success": true,
  "message": "ì¶œì„ ì¡°íšŒ ì„±ê³µ",
  "data": {
    "summary": {
      "attended": 1,
      "late": 0,
      "absent": 0,
      "totalSessions": 80,
      "attendanceRate": 1.25,
      "updatedAt": "2025-10-28 10:30:00"
    },
    "sessions": [
      {
        "sessionNumber": 1,
        "status": "ì¶œ",
        "requestDate": "2025-10-20 14:00:00",
        "approvedDate": "2025-10-20 15:30:00",
        "approvedBy": 1001,
        "tempApproved": false
      }
    ],
    "pendingRequests": [],
    "attendanceRate": "1/80",    // âœ¨ ì‹ ê·œ í•„ë“œ
    "attendanceStr": "ì¶œ"         // âœ¨ ì‹ ê·œ í•„ë“œ
  }
}
```

---

### 2. êµìˆ˜ ì¶œì„ ì¡°íšŒ (ì „ì²´ í•™ìƒ)
**Endpoint**: `POST /api/attendance/professor/view`

**Request**:
```json
{
  "lecSerial": "ETH201"
}
```

**Response** (ë³€ê²½ ì „):
```json
{
  "success": true,
  "message": "ì¶œì„ í˜„í™© ì¡°íšŒ ì„±ê³µ",
  "data": [
    {
      "studentIdx": 2001,
      "studentCode": "S2024001",
      "studentName": "í™ê¸¸ë™",
      "attendanceData": {
        "summary": {
          "attended": 3,
          "late": 1,
          "absent": 0,
          "totalSessions": 80,
          "attendanceRate": 3.9
        },
        "sessions": [
          { "sessionNumber": 1, "status": "ì¶œ" },
          { "sessionNumber": 2, "status": "ì¶œ" },
          { "sessionNumber": 3, "status": "ì§€" },
          { "sessionNumber": 4, "status": "ì¶œ" }
        ],
        "pendingRequests": []
      }
    }
  ]
}
```

**Response** (ë³€ê²½ í›„) âœ¨:
```json
{
  "success": true,
  "message": "ì¶œì„ í˜„í™© ì¡°íšŒ ì„±ê³µ",
  "data": [
    {
      "studentIdx": 2001,
      "studentCode": "S2024001",
      "studentName": "í™ê¸¸ë™",
      "attendanceData": {
        "summary": {
          "attended": 3,
          "late": 1,
          "absent": 0,
          "totalSessions": 80,
          "attendanceRate": 3.9
        },
        "sessions": [
          { "sessionNumber": 1, "status": "ì¶œ" },
          { "sessionNumber": 2, "status": "ì¶œ" },
          { "sessionNumber": 3, "status": "ì§€" },
          { "sessionNumber": 4, "status": "ì¶œ" }
        ],
        "pendingRequests": [],
        "attendanceRate": "3/80",    // âœ¨ ì‹ ê·œ í•„ë“œ
        "attendanceStr": "ì¶œì¶œì§€ì¶œ"   // âœ¨ ì‹ ê·œ í•„ë“œ
      }
    }
  ]
}
```

---

## ğŸ“Š ì‹ ê·œ í•„ë“œ ìƒì„¸ ì„¤ëª…

### 1. `attendanceRate` (String)
**íƒ€ì…**: `String`  
**í˜•ì‹**: `"ì¶œì„íšŸìˆ˜/ì´íšŒì°¨"`  
**ì˜ˆì‹œ**:
- ì¶œì„ ì•ˆ í•¨: `"0/80"`
- 1íšŒ ì¶œì„: `"1/80"`
- 15íšŒ ì¶œì„: `"15/80"`

**ê³„ì‚° ë¡œì§**:
```javascript
attendanceRate = summary.attended + "/" + summary.totalSessions
```

**ìš©ë„**: 
- UIì—ì„œ "n/80" í˜•íƒœë¡œ ë°”ë¡œ í‘œì‹œ ê°€ëŠ¥
- ê¸°ì¡´ `summary.attended`, `summary.totalSessions` ì‚¬ìš© ë¶ˆí•„ìš”

---

### 2. `attendanceStr` (String)
**íƒ€ì…**: `String`  
**í˜•ì‹**: íšŒì°¨ ìˆœì„œëŒ€ë¡œ ì¶œì„ ìƒíƒœë¥¼ ë‚˜ì—´í•œ ë¬¸ìì—´  
**ì˜ˆì‹œ**:
- ì¶œì„ ì—†ìŒ: `""` (ë¹ˆ ë¬¸ìì—´)
- 1íšŒì°¨ë§Œ ì¶œì„: `"ì¶œ"`
- 4íšŒì°¨ ì¶œì„ (ì¶œ/ì¶œ/ì§€/ê²°): `"ì¶œì¶œì§€ê²°"`
- 10íšŒì°¨ ì¶œì„: `"ì¶œì¶œì§€ì¶œê²°ì¶œì¶œì§€ì¶œì¶œ"`

**ê³„ì‚° ë¡œì§**:
```javascript
// sessions ë°°ì—´ì„ íšŒì°¨(sessionNumber) ìˆœìœ¼ë¡œ ì •ë ¬ í›„
// ê° statusì˜ ì²« ê¸€ìë§Œ ì¶”ì¶œí•˜ì—¬ ì—°ê²°
attendanceStr = sessions
  .sort((a, b) => a.sessionNumber - b.sessionNumber)
  .map(s => s.status.charAt(0))
  .join('')
```

**ìš©ë„**:
- ì¶œì„ íŒ¨í„´ ì‹œê°í™” (ì˜ˆ: ê·¸ë¦¬ë“œ ë·°)
- ì¶œì„ ìƒíƒœ í•œëˆˆì— íŒŒì•…

---

## ğŸ”„ ê¸°ì¡´ í•„ë“œ ìœ ì§€

### `summary` ê°ì²´ (ë³€ê²½ ì—†ìŒ)
```json
{
  "attended": 1,           // ì¶œì„ íšŸìˆ˜ (ìˆ«ì)
  "late": 0,               // ì§€ê° íšŸìˆ˜
  "absent": 0,             // ê²°ì„ íšŸìˆ˜
  "totalSessions": 80,     // ì´ íšŒì°¨ (ê³ ì •ê°’ 80)
  "attendanceRate": 1.25,  // ì¶œì„ë¥  í¼ì„¼íŠ¸ (ì†Œìˆ˜ì )
  "updatedAt": "2025-10-28 10:30:00"
}
```

**ì£¼ì˜**: 
- `summary.attendanceRate`ëŠ” **í¼ì„¼íŠ¸ ê°’** (Double): `1.25` = 1.25%
- ì‹ ê·œ `attendanceRate`ëŠ” **ë¬¸ìì—´**: `"1/80"`
- ë‘ í•„ë“œëŠ” **ì´ë¦„ì€ ê°™ì§€ë§Œ íƒ€ì…ê³¼ ì˜ë¯¸ê°€ ë‹¤ë¦„**

---

## ğŸ¯ í”„ë¡ íŠ¸ì—”ë“œ ìˆ˜ì • ê°€ì´ë“œ

### ë³€ê²½ ì „ (ê¸°ì¡´ ì½”ë“œ)
```javascript
// summaryì—ì„œ ì§ì ‘ ê³„ì‚°
const attendanceCount = data.summary.attended;
const totalSessions = data.summary.totalSessions;
const displayText = `${attendanceCount}/${totalSessions}`;  // "1/80"
```

### ë³€ê²½ í›„ (ê¶Œì¥ ì½”ë“œ) âœ…
```javascript
// ì‹ ê·œ í•„ë“œ ì§ì ‘ ì‚¬ìš©
const displayText = data.attendanceRate;  // "1/80" (ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥)
```

### ì¶œì„ ìƒíƒœ ë¬¸ìì—´ í™œìš© ì˜ˆì‹œ
```javascript
// ì¶œì„ íŒ¨í„´ í‘œì‹œ
const attendancePattern = data.attendanceStr;  // "ì¶œì¶œì§€ê²°ì¶œ"

// ë¬¸ìì—´ì„ ë°°ì—´ë¡œ ë³€í™˜í•˜ì—¬ ë Œë”ë§
const statusArray = attendancePattern.split('');
statusArray.forEach((status, index) => {
  console.log(`${index + 1}íšŒì°¨: ${status}`);
  // 1íšŒì°¨: ì¶œ
  // 2íšŒì°¨: ì¶œ
  // 3íšŒì°¨: ì§€
  // 4íšŒì°¨: ê²°
  // 5íšŒì°¨: ì¶œ
});
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ì¶œì„ ì—†ëŠ” ê²½ìš°
```json
{
  "summary": { "attended": 0, "totalSessions": 80 },
  "sessions": [],
  "attendanceRate": "0/80",
  "attendanceStr": ""
}
```

### 2. ì¼ë¶€ ì¶œì„í•œ ê²½ìš°
```json
{
  "summary": { "attended": 5, "late": 2, "totalSessions": 80 },
  "sessions": [
    { "sessionNumber": 1, "status": "ì¶œ" },
    { "sessionNumber": 2, "status": "ì§€" },
    { "sessionNumber": 3, "status": "ì¶œ" },
    { "sessionNumber": 5, "status": "ì¶œ" },
    { "sessionNumber": 7, "status": "ì¶œ" },
    { "sessionNumber": 8, "status": "ì§€" },
    { "sessionNumber": 10, "status": "ì¶œ" }
  ],
  "attendanceRate": "5/80",
  "attendanceStr": "ì¶œì§€ì¶œì¶œì§€ì¶œ"
}
```

### 3. ëŒ€ê¸° ì¤‘ì¸ ìš”ì²­ì´ ìˆëŠ” ê²½ìš°
```json
{
  "summary": { "attended": 1, "totalSessions": 80 },
  "sessions": [
    { "sessionNumber": 1, "status": "ì¶œ" }
  ],
  "pendingRequests": [
    {
      "sessionNumber": 2,
      "requestDate": "2025-10-28 09:00:00",
      "status": "PENDING"
    }
  ],
  "attendanceRate": "1/80",
  "attendanceStr": "ì¶œ"
}
```

**ì£¼ì˜**: `pendingRequests`ëŠ” `attendanceStr`ì— í¬í•¨ë˜ì§€ ì•ŠìŒ (ìŠ¹ì¸ëœ ì¶œì„ë§Œ í¬í•¨)

---

## ğŸš¨ í•˜ìœ„ í˜¸í™˜ì„±

### Breaking Change ì—†ìŒ âœ…
- ê¸°ì¡´ í•„ë“œ ëª¨ë‘ ìœ ì§€
- ì‹ ê·œ í•„ë“œë§Œ ì¶”ê°€
- ê¸°ì¡´ í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ ê·¸ëŒ€ë¡œ ì‘ë™

### ê¶Œì¥ ë§ˆì´ê·¸ë ˆì´ì…˜
```javascript
// ê¸°ì¡´ ì½”ë“œ (ê³„ì† ì‘ë™í•¨)
const count = data.summary.attended;  // âœ… OK

// ì‹ ê·œ ì½”ë“œ (ë” ê°„ë‹¨í•¨)
const rateText = data.attendanceRate;  // âœ… ê¶Œì¥
```

---

## ğŸ“ ìš”ì²­ì‚¬í•­ ì²´í¬ë¦¬ìŠ¤íŠ¸

í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë¶„ë“¤ê»˜:

- [ ] `attendanceRate` í•„ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ "n/80" í‘œì‹œ êµ¬í˜„
- [ ] `attendanceStr` í•„ë“œ í™œìš© ì—¬ë¶€ ê²€í†  (ì„ íƒì‚¬í•­)
- [ ] ê¸°ì¡´ `summary.attended` ê¸°ë°˜ ì½”ë“œê°€ ìˆë‹¤ë©´ `attendanceRate`ë¡œ êµì²´ ê³ ë ¤
- [ ] ì½˜ì†” ë¡œê·¸ì—ì„œ `"0/80"` ëŒ€ì‹  `"1/80"` ë“± ì •ìƒ ì¶œë ¥ í™•ì¸
- [ ] êµìˆ˜ ì¶œì„ ì¡°íšŒ í™”ë©´ì—ì„œë„ ë™ì¼í•˜ê²Œ ì ìš© í™•ì¸

---

## ğŸ”— ê´€ë ¨ API ë¬¸ì„œ

- **í•™ìƒ ì¶œì„ ì¡°íšŒ**: `POST /api/attendance/student/view`
- **ì¶œì„ ì¸ì • ìš”ì²­**: `POST /api/attendance/request`
- **êµìˆ˜ ì¶œì„ ì¡°íšŒ**: `POST /api/attendance/professor/view`
- **ì¶œì„ ìŠ¹ì¸/ì…ë ¥**: `POST /api/attendance/approve`

---

## ğŸ“ ë¬¸ì˜ì‚¬í•­

ë°±ì—”ë“œ ë³€ê²½ì‚¬í•­ ê´€ë ¨ ë¬¸ì˜ëŠ” ë°±ì—”ë“œíŒ€ìœ¼ë¡œ ì—°ë½ ì£¼ì„¸ìš”.

**ë°°í¬ ì˜ˆì •ì¼**: 2025-10-28 (ì˜¤ëŠ˜)  
**í…ŒìŠ¤íŠ¸ ì„œë²„**: https://bluecrab.chickenkiller.com/BlueCrab-1.0.0

---

## ğŸ‰ ê¸°ëŒ€ íš¨ê³¼

1. âœ… **ì¶œì„ íšŸìˆ˜ ì •ìƒ í‘œì‹œ**: "0/80" â†’ "1/80" ë“± ì‹¤ì œ ì¶œì„ ë°˜ì˜
2. âœ… **ì½”ë“œ ê°„ì†Œí™”**: ì§ì ‘ ì œê³µë˜ëŠ” ë¬¸ìì—´ ì‚¬ìš©ìœ¼ë¡œ í”„ë¡ íŠ¸ ê³„ì‚° ë¡œì§ ë¶ˆí•„ìš”
3. âœ… **ë°ì´í„° ì¼ê´€ì„±**: ë°±ì—”ë“œì—ì„œ ê³„ì‚°í•˜ì—¬ ì „ë‹¬í•˜ë¯€ë¡œ í”„ë¡ íŠ¸/ë°± ë¶ˆì¼ì¹˜ ë°©ì§€
4. âœ… **í™•ì¥ì„±**: `attendanceStr`ë¡œ ë‹¤ì–‘í•œ ì‹œê°í™” ê°€ëŠ¥

