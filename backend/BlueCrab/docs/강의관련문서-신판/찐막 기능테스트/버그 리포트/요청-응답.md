
---

# ğŸ“˜ ì¶œì„ API ìš”ì²­ ëª…ì„¸ì„œ (í”„ë¡ íŠ¸ì—”ë“œìš©) - ìˆ˜ì •íŒ

## ğŸ” ê³µí†µ ì‚¬í•­

### **ì¸ì¦ í—¤ë”**
```javascript
headers: {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer {JWT_ACCESS_TOKEN}'
}
```

---

## 1ï¸âƒ£ í•™ìƒ: ë‚´ ì¶œì„ í˜„í™© ì¡°íšŒ

### **Endpoint**
```
POST /api/attendance/student/view
```

### **ìš”ì²­ ì˜ˆì‹œ**
```javascript
{
  "lecSerial": "ETH201"
}
```

### **ì‘ë‹µ ì˜ˆì‹œ**
```javascript
{
  "success": true,
  "message": "ì¶œì„ í˜„í™© ì¡°íšŒ ì„±ê³µ",
  "data": {
    "summary": {
      "attended": 1,           // ì¶œì„ íšŸìˆ˜
      "late": 1,              // ì§€ê° íšŸìˆ˜
      "absent": 0,            // ê²°ì„ íšŸìˆ˜
      "totalSessions": 80,    // ì „ì²´ ê°•ì˜ íšŒì°¨ (ê³ ì •)
      "attendanceRate": 2.0,  // ì¶œì„ë¥  (%) - ì§€ê° íŒ¨ë„í‹° ë°˜ì˜
      "updatedAt": "2025-10-28T15:30:00"
    },
    "sessions": [
      {
        "sessionNumber": 1,
        "status": "ì¶œ",
        "requestDate": "2025-10-28T14:58:16",
        "approvedDate": "2025-10-28T15:15:26",
        "approvedBy": 25,
        "tempApproved": false
      },
      {
        "sessionNumber": 2,
        "status": "ì§€",
        "requestDate": null,
        "approvedDate": "2025-10-28T15:20:00",
        "approvedBy": 25,
        "tempApproved": false
      }
    ],
    "pendingRequests": [
      {
        "sessionNumber": 3,
        "requestDate": "2025-10-28T15:07:15",
        "requestReason": "êµí†µì²´ì¦ìœ¼ë¡œ ì§€ê°",
        "expiresAt": "2025-11-04T00:00:00",
        "tempApproved": true
      }
    ]
  }
}
```

---

## 2ï¸âƒ£ í•™ìƒ: ì¶œì„ ì¸ì • ìš”ì²­

### **Endpoint**
```
POST /api/attendance/request
```

### **ìš”ì²­ ì˜ˆì‹œ**
```javascript
{
  "lecSerial": "ETH201",
  "sessionNumber": 5,
  "requestReason": "êµí†µì²´ì¦ìœ¼ë¡œ ì§€ê°"
}
```

### **í•„ë“œ ì„¤ëª…**
| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| lecSerial | String | âœ… | ê°•ì˜ ì½”ë“œ (ì˜ˆ: ETH201) |
| sessionNumber | Integer | âœ… | íšŒì°¨ ë²ˆí˜¸ (1~80) |
| requestReason | String | âš ï¸ | ìš”ì²­ ì‚¬ìœ  (ì„ íƒ, 200ì ì´ë‚´) |

### **ì‘ë‹µ ì˜ˆì‹œ**
```javascript
{
  "success": true,
  "message": "ì¶œì„ ì¸ì • ìš”ì²­ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "data": {
    "summary": {
      "attended": 1,
      "late": 1,
      "absent": 0,
      "totalSessions": 80,
      "attendanceRate": 2.0,
      "updatedAt": "2025-10-28T15:30:00"
    },
    "sessions": [ /* ... */ ],
    "pendingRequests": [
      {
        "sessionNumber": 5,
        "requestDate": "2025-10-28T15:30:00",
        "requestReason": "êµí†µì²´ì¦ìœ¼ë¡œ ì§€ê°",
        "expiresAt": "2025-11-04T00:00:00",
        "tempApproved": true
      }
    ]
  }
}
```

---

## 3ï¸âƒ£ êµìˆ˜: ì „ì²´ í•™ìƒ ì¶œì„ í˜„í™© ì¡°íšŒ

### **Endpoint**
```
POST /api/attendance/professor/view
```

### **ìš”ì²­ ì˜ˆì‹œ**
```javascript
{
  "lecSerial": "ETH201"
}
```

### **ì‘ë‹µ ì˜ˆì‹œ**
```javascript
{
  "success": true,
  "message": "ì¶œì„ í˜„í™© ì¡°íšŒ ì„±ê³µ",
  "data": [
    {
      "studentIdx": 6,
      "studentName": "í…ŒìŠ¤í„°",
      "studentCode": "0",
      "attendanceData": {
        "summary": {
          "attended": 1,
          "late": 1,
          "absent": 0,
          "totalSessions": 80,
          "attendanceRate": 2.0,
          "updatedAt": "2025-10-28T15:30:00"
        },
        "sessions": [ /* ... */ ],
        "pendingRequests": [ /* ... */ ]
      }
    },
    {
      "studentIdx": 33,
      "studentName": "ê¹€ë¯¼ì¤€",
      "studentCode": "202500106114",
      "attendanceData": {
        "summary": {
          "attended": 0,
          "late": 0,
          "absent": 0,
          "totalSessions": 80,
          "attendanceRate": 0.0,
          "updatedAt": "2025-10-28T15:30:00"
        },
        "sessions": [],
        "pendingRequests": []
      }
    }
    // ... 25ëª… ì „ì²´
  ]
}
```

---

## 4ï¸âƒ£ êµìˆ˜: ì¶œì„ ìŠ¹ì¸/ì…ë ¥

### **Endpoint**
```
POST /api/attendance/approve
```

### **ìš”ì²­ ì˜ˆì‹œ (ë‹¨ì¼ í•™ìƒ)**
```javascript
{
  "lecSerial": "ETH201",
  "sessionNumber": 5,
  "attendanceRecords": [
    {
      "studentIdx": 6,
      "status": "ì¶œ"
    }
  ]
}
```

### **ìš”ì²­ ì˜ˆì‹œ (ì—¬ëŸ¬ í•™ìƒ ë™ì‹œ ì²˜ë¦¬)**
```javascript
{
  "lecSerial": "ETH201",
  "sessionNumber": 5,
  "attendanceRecords": [
    {
      "studentIdx": 6,
      "status": "ì¶œ"
    },
    {
      "studentIdx": 33,
      "status": "ì§€"
    },
    {
      "studentIdx": 34,
      "status": "ê²°"
    }
  ]
}
```

### **í•„ë“œ ì„¤ëª…**
| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| lecSerial | String | âœ… | ê°•ì˜ ì½”ë“œ |
| sessionNumber | Integer | âœ… | íšŒì°¨ ë²ˆí˜¸ (1~80) |
| attendanceRecords | Array | âœ… | ì¶œì„ ê¸°ë¡ ë°°ì—´ (1ê°œ ì´ìƒ) |
| attendanceRecords[].studentIdx | Integer | âœ… | í•™ìƒ USER_IDX |
| attendanceRecords[].status | String | âœ… | ì¶œì„ ìƒíƒœ: **"ì¶œ"** / **"ì§€"** / **"ê²°"** |

### **ì¶œì„ ìƒíƒœ ê°’**
- `"ì¶œ"` - ì¶œì„ (1.0íšŒ ì¶œì„)
- `"ì§€"` - ì§€ê° (0.6íšŒ ì¶œì„, 0.4 íŒ¨ë„í‹° ì ìš©)
- `"ê²°"` - ê²°ì„ (0.0íšŒ ì¶œì„)

### **ì‘ë‹µ ì˜ˆì‹œ**
```javascript
{
  "success": true,
  "message": "ì¶œì„ ìŠ¹ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. (3/3)",
  "data": null
}
```

---

## ğŸ“Š ì¶œì„ë¥  ê³„ì‚° ë¡œì§

### **ê³µì‹**
```javascript
// 1. ì‹¤ì œ ì¶œì„ íšŸìˆ˜ ê³„ì‚° (ì§€ê° íŒ¨ë„í‹° ë°˜ì˜)
const effectiveAttendance = attended + (late Ã— (1 - latePenalty));

// ì˜ˆì‹œ: latePenalty = 0.4
// attended = 1, late = 1
// effectiveAttendance = 1 + (1 Ã— 0.6) = 1.6

// 2. ì¶œì„ë¥  ê³„ì‚°
const attendanceRate = (effectiveAttendance / 80) Ã— 100;

// ì˜ˆì‹œ: (1.6 / 80) Ã— 100 = 2.0%
```

### **ì˜ˆì‹œ ê³„ì‚°í‘œ**

| ì¶œì„ | ì§€ê° | ê²°ì„ | ì‹¤ì œ ì¶œì„ | ì¶œì„ë¥  |
|------|------|------|-----------|--------|
| 0 | 0 | 0 | 0.0 | **0.0%** |
| 1 | 0 | 0 | 1.0 | **1.25%** |
| 1 | 1 | 0 | 1.6 | **2.0%** |
| 2 | 1 | 0 | 2.6 | **3.25%** |
| 10 | 5 | 0 | 13.0 | **16.25%** |
| 40 | 0 | 0 | 40.0 | **50.0%** |
| 80 | 0 | 0 | 80.0 | **100.0%** |

---

## âŒ ì—ëŸ¬ ì‘ë‹µ

### **ê³µí†µ ì—ëŸ¬ í˜•ì‹**
```javascript
{
  "success": false,
  "message": "ì—ëŸ¬ ë©”ì‹œì§€",
  "data": null
}
```

### **ì£¼ìš” ì—ëŸ¬ ì¼€ì´ìŠ¤**

| ìƒí™© | HTTP | message |
|------|------|---------|
| ì¸ì¦ í† í° ì—†ìŒ | 401 | "ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤." |
| êµìˆ˜ ê¶Œí•œ ì—†ìŒ | 403 | "êµìˆ˜ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤." |
| ê°•ì˜ ì½”ë“œ ëˆ„ë½ | 400 | "ê°•ì˜ ì½”ë“œ(lecSerial)ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤." |
| ìˆ˜ê°•ì‹ ì²­ ì—†ìŒ | 400 | "ìˆ˜ê°•ì‹ ì²­ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤." |
| ì¤‘ë³µ ìš”ì²­ | 400 | "ì´ë¯¸ í•´ë‹¹ íšŒì°¨ì˜ ì¶œì„ ê¸°ë¡ì´ ì¡´ì¬í•©ë‹ˆë‹¤." |
| ì˜ëª»ëœ íšŒì°¨ | 400 | "ìœ íš¨í•˜ì§€ ì•Šì€ íšŒì°¨ ë²ˆí˜¸ì…ë‹ˆë‹¤. (1~80)" |
| ì˜ëª»ëœ ìƒíƒœ | 400 | "ìœ íš¨í•˜ì§€ ì•Šì€ ì¶œì„ ìƒíƒœì…ë‹ˆë‹¤. (ì¶œ/ì§€/ê²°)" |

---

## ğŸ¯ í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê°€ì´ë“œ

### **JavaScript ì˜ˆì‹œ**
```javascript
// ì¶œì„ ìŠ¹ì¸ API í˜¸ì¶œ (êµìˆ˜ìš©)
async function approveAttendance(lecSerial, sessionNumber, studentIdx, status) {
  const response = await fetch('https://bluecrab.chickenkiller.com/BlueCrab-1.0.0/api/attendance/approve', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${window.authToken}`
    },
    body: JSON.stringify({
      lecSerial: lecSerial,
      sessionNumber: sessionNumber,
      attendanceRecords: [
        {
          studentIdx: studentIdx,
          status: status  // "ì¶œ", "ì§€", "ê²°"
        }
      ]
    })
  });
  
  const result = await response.json();
  
  if (result.success) {
    console.log('âœ… ì¶œì„ ìŠ¹ì¸ ì„±ê³µ!');
  } else {
    console.error('âŒ ì¶œì„ ìŠ¹ì¸ ì‹¤íŒ¨:', result.message);
  }
  
  return result;
}

// ì‚¬ìš© ì˜ˆì‹œ
await approveAttendance('ETH201', 5, 6, 'ì¶œ');
```

---

**ì£¼ìš” ë³€ê²½ì‚¬í•­:**
- âŒ "ì¡°"(ì¡°í‡´) ì œê±°
- âœ… "ì¶œ", "ì§€", "ê²°" 3ê°€ì§€ ìƒíƒœë§Œ ì‚¬ìš©

ì´ ë¬¸ì„œë¥¼ í”„ë¡ íŠ¸ì—”ë“œ íŒ€ì—ê²Œ ì „ë‹¬í•˜ì‹œë©´ ë©ë‹ˆë‹¤! ğŸ“§