# BlueCrab 백엔드 전체 구조 분석

> **분석 일자**: 2025-09-28  
> **분석 범위**: backend/BlueCrab/src/main/java/BlueCrab/com/example  
> **분석자**: Backend Analysis Phase 1

## 📊 전체 구조 개요

### 🏗️ 패키지 구조
```
BlueCrab.com.example/
├── 📁 controller/          # REST API 엔드포인트 (14개 클래스)
├── 📁 service/             # 비즈니스 로직 (13개 클래스)  
├── 📁 util/                # 유틸리티 클래스 (18개 클래스)
├── 📁 repository/          # 데이터 접근 계층
├── 📁 entity/              # JPA 엔티티
├── 📁 dto/                 # 데이터 전송 객체
├── 📁 config/              # 설정 클래스
├── 📁 security/            # 보안 관련
├── 📁 exception/           # 예외 처리
├── 📁 model/               # 모델 클래스
└── 📁 interceptor/         # 인터셉터
```

## 🎯 Controller 계층 분석 (14개)

### 📋 Controller 목록 및 역할
| 클래스명 | 기본 경로 | 주요 기능 | 복잡도 | 우선 분석 |
|---------|----------|----------|--------|-----------|
| **AdminController** | `/api/admin` | 관리자 인증 관리 | 🟡 중간 | ⭐ 높음 |
| **AdminEmailAuthController** | `/api/admin/email` | 관리자 이메일 인증 | 🟡 중간 | ⭐ 높음 |
| **ApiController** | `/api` | 시스템 상태/테스트 | 🟢 낮음 | ⭐ 낮음 |
| **AuthController** | `/api/auth` | 사용자 인증 | 🔴 높음 | ⭐⭐⭐ 최고 |
| **BoardController** | `/api/boards` | 게시판 관리 | 🔴 높음 | ⭐⭐ 높음 |
| **DatabaseController** | `/api/database` | 데이터베이스 관리 | 🟡 중간 | ⭐ 중간 |
| **FindIdController** | `/api/account` | 아이디 찾기 | 🟡 중간 | ⭐ 중간 |
| **HomeController** | `/` | 홈페이지 | 🟢 낮음 | ⭐ 낮음 |
| **LogMonitorController** | `/api/logs` | 로그 모니터링 | 🟡 중간 | ⭐ 낮음 |
| **MailAuthCheckController** | `/api/mail` | 메일 인증 확인 | 🟡 중간 | ⭐ 중간 |
| **MetricsController** | `/api/metrics` | 시스템 메트릭 | 🟡 중간 | ⭐ 낮음 |
| **PasswordResetController** | `/api/auth/password-reset` | 비밀번호 재설정 | 🔴 높음 | ⭐⭐ 높음 |
| **ProfileController** | `/api/profile` | 프로필 관리 | 🟡 중간 | ⭐ 중간 |
| **UserController** | `/api/users` | 사용자 관리 | 🔴 높음 | ⭐⭐ 높음 |

### 🔍 Controller 분류

#### 🔐 **인증/보안 관련 Controller (5개)**
- `AuthController` - 기본 사용자 인증
- `AdminController` - 관리자 인증  
- `AdminEmailAuthController` - 관리자 이메일 인증
- `PasswordResetController` - 비밀번호 재설정
- `FindIdController` - 아이디 찾기

#### 👥 **사용자/프로필 관리 Controller (2개)**
- `UserController` - 사용자 관리
- `ProfileController` - 프로필 관리

#### 📝 **콘텐츠 관리 Controller (1개)**
- `BoardController` - 게시판 관리

#### 📧 **메일/통신 관련 Controller (1개)**
- `MailAuthCheckController` - 메일 인증

#### 🛠️ **시스템/관리 Controller (5개)**
- `ApiController` - API 상태 체크
- `DatabaseController` - 데이터베이스 관리
- `LogMonitorController` - 로그 모니터링
- `MetricsController` - 시스템 메트릭
- `HomeController` - 홈페이지

## 🔧 Service 계층 분석 (13개)

### 📋 Service 목록 및 역할
| 클래스명 | 주요 기능 | 연관 Controller | 복잡도 |
|---------|----------|----------------|--------|
| **AdminService** | 관리자 비즈니스 로직 | AdminController | 🔴 높음 |
| **AuthService** | 인증 비즈니스 로직 | AuthController | 🔴 높음 |
| **BoardService** | 게시판 비즈니스 로직 | BoardController | 🔴 높음 |
| **EmailService** | 이메일 발송 서비스 | 여러 Controller | 🟡 중간 |
| **EmailVerificationService** | 이메일 인증 서비스 | 인증 관련 Controller | 🟡 중간 |
| **ImageCacheService** | 이미지 캐시 서비스 | ProfileController | 🟡 중간 |
| **MinIOService** | 파일 스토리지 서비스 | ProfileController | 🟡 중간 |
| **PasswordResetService** | 비밀번호 재설정 서비스 | PasswordResetController | 🔴 높음 |
| **ProfileService** | 프로필 서비스 | ProfileController | 🟡 중간 |
| **RedisService** | Redis 캐시 서비스 | 여러 Service | 🟡 중간 |
| **TokenBlacklistArchiveService** | 토큰 블랙리스트 아카이브 | AuthService | 🟡 중간 |
| **TokenBlacklistService** | 토큰 블랙리스트 관리 | AuthService | 🟡 중간 |
| **UserTblService** | 사용자 테이블 서비스 | UserController | 🔴 높음 |

## 🛠️ Util 계층 분석 (18개)

### 📋 Util 클래스 기능별 분류

#### 🔐 **인증/보안 관련 Util (7개)**
| 클래스명 | 기능 | 중복 가능성 |
|---------|------|-----------|
| `JwtUtil` | JWT 토큰 일반 처리 | 🟡 중간 |
| `AdminJwtTokenBuilder` | 관리자 JWT 토큰 생성 | 🔴 높음 |
| `AdminTokenValidator` | 관리자 토큰 검증 | 🔴 높음 |
| `AuthCodeGenerator` | 인증 코드 생성 | 🟡 중간 |
| `AuthCodeValidator` | 인증 코드 검증 | 🟡 중간 |
| `SHA256Util` | 해시 암호화 | 🟢 낮음 |
| `UserVerificationUtils` | 사용자 검증 유틸 | 🟡 중간 |

#### ⏱️ **Rate Limiting 관련 Util (3개)**
| 클래스명 | 기능 | 중복 가능성 |
|---------|------|-----------|
| `MailAuthRateLimitUtils` | 메일 인증 속도 제한 | 🔴 높음 |
| `PasswordResetRateLimiter` | 비밀번호 재설정 속도 제한 | 🔴 높음 |
| `AccountRecoveryRateLimiter` | 계정 복구 속도 제한 | 🔴 높음 |

#### 🗄️ **데이터 관리 관련 Util (4개)**
| 클래스명 | 기능 | 중복 가능성 |
|---------|------|-----------|
| `RedisAuthDataManager` | Redis 인증 데이터 관리 | 🟡 중간 |
| `PasswordResetRedisUtil` | 비밀번호 재설정 Redis | 🔴 높음 |
| `PasswordResetTokenManager` | 비밀번호 재설정 토큰 관리 | 🟡 중간 |
| `SlowQueryLogger` | 느린 쿼리 로깅 | 🟢 낮음 |

#### 📧 **통신/템플릿 관련 Util (2개)**
| 클래스명 | 기능 | 중복 가능성 |
|---------|------|-----------|
| `EmailTemplateUtils` | 이메일 템플릿 처리 | 🟢 낮음 |
| `RequestUtils` | HTTP 요청 처리 유틸 | 🟢 낮음 |

#### 🔧 **기타 Util (2개)**
| 클래스명 | 기능 | 중복 가능성 |
|---------|------|-----------|
| `AdminAuthResponseBuilder` | 관리자 인증 응답 빌더 | 🟡 중간 |
| `UserNameExtractor` | 사용자명 추출 | 🟢 낮음 |

## 🚨 초기 발견 사항

### ⚠️ **높은 우선순위 개선 사항**

#### 1. **중복 기능 의심 영역**
- **JWT 관련**: `JwtUtil` vs `AdminJwtTokenBuilder` vs `AdminTokenValidator`
- **Rate Limiting**: 3개의 별도 Rate Limiter 클래스
- **Redis 관리**: `RedisService` vs `RedisAuthDataManager` vs `PasswordResetRedisUtil`
- **인증 코드**: `AuthCodeGenerator` + `AuthCodeValidator` 분리 필요성 검토

#### 2. **Controller 복잡도 이슈**
- `AuthController`: 인증 관련 모든 기능 집중
- `BoardController`: 게시판 CRUD + 특수 기능들
- `UserController`: 사용자 관리 + 통계 기능
- `PasswordResetController`: 4단계 프로세스 관리

#### 3. **네이밍 일관성**
- `UserTblService` (테이블명 포함) vs 다른 Service들
- `MailAuthCheckController` vs `EmailService` (Mail vs Email)

### 🎯 **Phase 2 분석 우선순위**

#### 🔴 **최우선 (Critical)**
1. `AuthController` - 핵심 인증 로직
2. `AdminController` + `AdminEmailAuthController` - 관리자 인증 중복 검토
3. JWT 관련 Util 클래스들 - 기능 중복 분석

#### 🟡 **높은 우선순위 (High)**
1. `BoardController` + `BoardService` - 복잡한 비즈니스 로직
2. `PasswordResetController` + `PasswordResetService` - 프로세스 최적화
3. Rate Limiting 관련 Util들 - 통합 가능성 검토

#### 🟢 **중간 우선순위 (Medium)**
1. `UserController` + `UserTblService` - 기능 분리 검토
2. `ProfileController` + `ProfileService` - 이미지 처리 로직
3. Redis 관련 서비스들 - 역할 명확화

## 📋 다음 단계 계획

### Phase 2 준비사항
1. **각 Controller별 상세 API 엔드포인트 분석**
2. **Service 계층 의존성 관계 매핑**
3. **Util 클래스간 기능 중복도 측정**
4. **보안 취약점 및 성능 이슈 식별**

---
*이 문서는 Phase 1 기초 분석 결과이며, Phase 2에서 각 클래스별 상세 분석을 진행할 예정입니다.*