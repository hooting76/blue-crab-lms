# API 테스터 테스트 가이드

## 🚀 서버 시작 방법

### 1. 백엔드 서버 시작
```bash
cd backend/BlueCrab
./mvnw spring-boot:run
# 또는
mvn spring-boot:run
```

### 2. 브라우저에서 접속
```
http://localhost:8080/
```

## ✅ 기능 테스트 체크리스트

### Phase 1: 기본 로딩 테스트

#### 1.1 페이지 로드
- [ ] 페이지가 정상적으로 로드됨
- [ ] 서버 정보 바가 표시됨 (상태, 시간, 버전)
- [ ] 3단 레이아웃이 정상 표시됨 (로그인 | API 테스트 | 저장 패널)

#### 1.2 개발자 도구 확인
**브라우저 개발자 도구 열기 (F12)**

**Console 탭 확인**:
- [ ] `Base URL: http://localhost:8080` 출력
- [ ] `Server Info: {status: ..., version: ..., serverTime: ...}` 출력
- [ ] `API templates loaded: {...}` 출력
- [ ] 에러 메시지 없음

**Network 탭 확인**:
- [ ] `api-tester.css` - 200 OK
- [ ] `api-tester.js` - 200 OK
- [ ] `token-manager.js` - 200 OK
- [ ] `history-manager.js` - 200 OK
- [ ] `ui-utils.js` - 200 OK
- [ ] `api-templates.json` - 200 OK

**Sources 탭 확인**:
```
localhost:8080
├── css
│   └── api-tester.css
├── js
│   ├── api-tester.js
│   ├── token-manager.js
│   ├── history-manager.js
│   └── ui-utils.js
└── config
    └── api-templates.json
```

### Phase 2: 공개 API 테스트 (인증 불필요)

#### 2.1 Ping API
1. **엔드포인트 선택**: "🔓 Ping (인증 불필요)"
2. **HTTP 메소드**: GET (자동 설정)
3. **API 호출 버튼 클릭**
4. **기대 결과**:
   - [ ] 응답 창 배경색: 초록색 (성공)
   - [ ] 상태 코드: `Status: 200 OK`
   - [ ] 응답 시간: `응답시간: XXms`
   - [ ] JSON 응답 표시
   - [ ] 히스토리에 자동 저장됨

#### 2.2 Health Check API
1. **엔드포인트 선택**: "🔓 Health Check"
2. **API 호출 버튼 클릭**
3. **기대 결과**:
   - [ ] 성공 응답
   - [ ] 서버 상태 정보 표시

### Phase 3: 로그인 기능 테스트

#### 3.1 일반 사용자 로그인
**테스트 계정** (실제 DB에 있는 계정 사용):
```
사용자명: [실제 이메일]
비밀번호: [실제 비밀번호]
```

**테스트 단계**:
1. 사용자명과 비밀번호 입력
2. "로그인" 버튼 클릭
3. **기대 결과**:
   - [ ] 로그인 성공 메시지
   - [ ] 토큰 정보 박스 표시됨
   - [ ] Access Token 표시 (앞 50자 + ...)
   - [ ] Refresh Token 표시
   - [ ] 만료 시간 표시
   - [ ] "토큰 내용 보기/숨기기" 버튼 활성화

#### 3.2 토큰 디코딩 확인
1. "토큰 내용 보기/숨기기" 버튼 클릭
2. **기대 결과**:
   - [ ] JWT 페이로드가 JSON 형식으로 표시
   - [ ] `sub` (사용자명), `exp` (만료시간) 등 포함

#### 3.3 LocalStorage 확인
**개발자 도구 > Application 탭 > Local Storage**:
- [ ] `bluecrab_access_token` 키 존재
- [ ] `bluecrab_refresh_token` 키 존재

### Phase 4: 토큰 세트 관리 테스트

#### 4.1 토큰 세트 저장
1. 로그인 후 토큰이 있는 상태에서
2. 저장 패널의 "토큰 세트 이름" 입력: `test-user-01`
3. "현재 토큰 저장" 버튼 클릭
4. **기대 결과**:
   - [ ] 알림: `토큰 세트 "test-user-01" 저장 완료!`
   - [ ] 저장된 토큰 세트 목록에 표시됨
   - [ ] 세트 이름과 저장 시간 표시
   - [ ] "불러오기", "삭제" 버튼 표시

#### 4.2 토큰 세트 불러오기
1. 먼저 "로그아웃" 버튼 클릭 (토큰 제거)
2. 저장된 토큰 세트에서 "불러오기" 클릭
3. **기대 결과**:
   - [ ] 응답 창: `토큰 세트 "test-user-01" 불러오기 완료!`
   - [ ] 토큰 정보 박스 다시 표시됨
   - [ ] Access/Refresh Token 복원됨

#### 4.3 토큰 세트 삭제
1. 저장된 토큰 세트에서 "삭제" 클릭
2. 확인 대화상자 승인
3. **기대 결과**:
   - [ ] 목록에서 제거됨
   - [ ] "저장된 토큰 세트가 없습니다" 표시

### Phase 5: 인증 필요 API 테스트

#### 5.1 사용자 프로필 조회
**전제조건**: 로그인된 상태

1. **엔드포인트 선택**: "🔒 사용자 프로필 조회"
2. **HTTP 메소드**: GET (자동 설정)
3. **API 호출 버튼 클릭**
4. **기대 결과**:
   - [ ] 성공 응답 (200 OK)
   - [ ] 사용자 정보 JSON 표시
   - [ ] Authorization 헤더에 Bearer 토큰 자동 포함됨

#### 5.2 사용자 목록 조회 (관리자 전용)
**전제조건**: 관리자 계정으로 로그인

1. **엔드포인트 선택**: "🔒 사용자 목록 조회 (관리자 전용)"
2. **동적 파라미터 확인**:
   - [ ] `page` 입력 필드 자동 생성 (예제: 1)
   - [ ] `size` 입력 필드 자동 생성 (예제: 10)
   - [ ] 파라미터 설명 표시
3. **파라미터 수정**: page=2, size=5
4. **API 호출 버튼 클릭**
5. **기대 결과**:
   - [ ] 성공 응답 또는 권한 오류 (일반 사용자인 경우)
   - [ ] URL에 쿼리스트링 포함: `/api/user/list?page=2&size=5`

### Phase 6: 관리자 2단계 인증 테스트

#### 6.1 Step 1 - 인증코드 요청
**전제조건**: 관리자 임시 토큰 필요

1. "임시 토큰" 입력 필드에 임시 토큰 입력
2. "Step 1: 인증코드 요청" 버튼 클릭
3. **기대 결과**:
   - [ ] 상태 메시지: "인증코드가 이메일로 전송되었습니다"
   - [ ] Step 2 섹션이 표시됨
   - [ ] 응답 창에 성공 메시지

#### 6.2 Step 2 - 인증코드 검증
1. 이메일에서 받은 6자리 코드 입력
2. "Step 2: 인증코드 검증" 버튼 클릭
3. **기대 결과**:
   - [ ] 상태 메시지: "관리자 인증 성공! 토큰이 저장되었습니다"
   - [ ] 토큰 정보 박스 표시
   - [ ] Access Token, Refresh Token 저장
   - [ ] Step 1, 2 필드 초기화

### Phase 7: 요청 히스토리 테스트

#### 7.1 히스토리 자동 저장
1. 여러 API 호출 (5-6개)
2. **기대 결과**:
   - [ ] 각 요청이 히스토리에 자동 저장됨
   - [ ] 최신 요청이 맨 위에 표시
   - [ ] HTTP 메소드 태그 표시 (GET=녹색, POST=노란색 등)
   - [ ] 상태 코드와 응답 시간 표시
   - [ ] 엔드포인트 경로 표시

#### 7.2 요청 재실행
1. 히스토리 항목에서 "재실행" 버튼 클릭
2. **기대 결과**:
   - [ ] 폼 필드가 해당 요청 정보로 자동 채워짐
   - [ ] HTTP 메소드 설정됨
   - [ ] 요청 본문이 있었다면 복원됨
   - [ ] 커스텀 URL로 설정됨
   - [ ] API가 자동 실행됨

#### 7.3 히스토리 삭제
1. 히스토리 항목에서 "삭제" 버튼 클릭
2. **기대 결과**:
   - [ ] 해당 항목만 목록에서 제거됨

#### 7.4 히스토리 전체 삭제
1. "히스토리 전체 삭제" 버튼 클릭
2. 확인 대화상자 승인
3. **기대 결과**:
   - [ ] 모든 히스토리 제거됨
   - [ ] "히스토리가 없습니다" 표시

### Phase 8: 토큰 갱신 테스트

#### 8.1 Refresh Token으로 갱신
**전제조건**: 로그인된 상태 (Refresh Token 있음)

1. "토큰 갱신" 버튼 클릭
2. **기대 결과**:
   - [ ] 성공 메시지
   - [ ] 새로운 Access Token 발급
   - [ ] Refresh Token 갱신 (있는 경우)
   - [ ] 토큰 정보 업데이트

### Phase 9: 커스텀 URL 테스트

#### 9.1 커스텀 엔드포인트 호출
1. **엔드포인트 선택**: "커스텀 URL"
2. **커스텀 URL 입력**: `/api/custom-endpoint`
3. **HTTP 메소드**: POST 선택
4. **요청 본문**:
   ```json
   {
     "key": "value"
   }
   ```
5. **API 호출 버튼 클릭**
6. **기대 결과**:
   - [ ] 요청이 전송됨
   - [ ] 404 또는 실제 응답 수신 (엔드포인트 존재 여부에 따라)
   - [ ] 히스토리에 저장됨

### Phase 10: 에러 처리 테스트

#### 10.1 잘못된 자격증명
1. 틀린 사용자명/비밀번호로 로그인 시도
2. **기대 결과**:
   - [ ] 빨간색 배경 (에러)
   - [ ] 로그인 실패 메시지
   - [ ] 상태 코드 표시

#### 10.2 유효하지 않은 JSON
1. 요청 본문에 잘못된 JSON 입력:
   ```
   {invalid json}
   ```
2. API 호출 시도
3. **기대 결과**:
   - [ ] 에러 메시지: "요청 본문이 유효한 JSON이 아닙니다"

#### 10.3 인증 없이 보호된 API 호출
1. 로그아웃 상태에서
2. 보호된 API 호출 시도
3. **기대 결과**:
   - [ ] 401 Unauthorized 또는 403 Forbidden
   - [ ] 에러 메시지 표시

## 🐛 문제 해결 가이드

### 문제 1: JavaScript 파일 로드 실패 (404)
**증상**: 개발자 도구 Network 탭에서 JS 파일이 404

**해결책**:
1. Spring Boot 서버가 정상 실행 중인지 확인
2. `static/` 폴더 구조 확인:
   ```
   src/main/resources/static/
   ├── css/api-tester.css
   ├── js/...
   └── config/api-templates.json
   ```
3. 서버 재시작

### 문제 2: API 템플릿이 로드되지 않음
**증상**: Console에 "Failed to load API templates" 에러

**해결책**:
1. `api-templates.json` 파일이 존재하는지 확인
2. JSON 문법 오류 확인 (JSONLint 등으로 검증)
3. 브라우저에서 직접 접근: `http://localhost:8080/config/api-templates.json`

### 문제 3: 토큰이 저장되지 않음
**증상**: LocalStorage에 토큰이 없음

**해결책**:
1. 브라우저 개발자 도구 > Console 확인
2. LocalStorage가 활성화되어 있는지 확인 (시크릿 모드에서는 제한될 수 있음)
3. CORS 문제인지 확인

### 문제 4: 스타일이 적용되지 않음
**증상**: 페이지가 스타일 없이 표시

**해결책**:
1. `api-tester.css` 로드 확인 (Network 탭)
2. Thymeleaf 경로 문제: `th:href="@{/css/api-tester.css}"`
3. 브라우저 캐시 강제 새로고침 (Ctrl+Shift+R)

## 📊 성공 기준

### ✅ 모든 기능 정상 작동
- [ ] 20/20 기능 테스트 통과
- [ ] 에러 없이 로드
- [ ] 모든 API 호출 가능
- [ ] 토큰 관리 정상 작동
- [ ] 히스토리 저장/복원 가능

### ✅ 성능 기준
- [ ] 페이지 로드 시간 < 2초
- [ ] API 응답 시간 < 500ms (로컬 기준)
- [ ] JavaScript 실행 에러 없음

### ✅ 코드 품질
- [ ] 개발자 도구 Console에 에러 없음
- [ ] Network 탭에서 모든 리소스 200 OK
- [ ] 메모리 누수 없음 (Performance 탭 확인)

## 🎯 다음 단계

테스트 완료 후:
1. ✅ 모든 체크리스트 항목 확인
2. 📝 발견된 버그 기록
3. 🔧 수정 사항 적용
4. 🚀 프로덕션 배포 준비
